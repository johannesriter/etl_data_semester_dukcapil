import arcpy
import csv
import datetime
import glob
import os
# import os.path
import psycopg2
import sys
import time
from watchdog.observers import Observer
from watchdog.events import LoggingEventHandler, FileSystemEventHandler
from watchdog.observers.polling import PollingObserver

arcpy.env.overwriteOutput = True

# upload_file = arcpy.GetParameterAsText(0)
destination_folder = r'\\otomasi.dukcapil.kemendagri.go.id\otomasi'

class MyWatcher:
	destination_folder = r'\\otomasi.dukcapil.kemendagri.go.id\otomasi'

	def __init__(self):
		self.observer = PollingObserver()

	def run(self):
		event_handler = ExampleHandler()
		self.observer.schedule(event_handler, self.destination_folder, recursive=True)
		self.observer.start()
		try:
			while True:
				time.sleep(1)
		except:
			self.observer.stop
			print("Observer stopped.")
		self.observer.join()

class ExampleHandler(FileSystemEventHandler):
	def on_created(event): # when file is created
		fullstring =  event.src_path
		substring = '.csv'
		# arcpy.AddMessage("Event for current automation: {}".format(fullstring))
		return fullstring

# file_type = r'\*csv'
# files = glob.glob(destination_folder + file_type)
# upload_file = max(files, key=os.path.getctime)
# arcpy.AddMessage(upload_file)

output_gdb = arcpy.env.workspace = r'C:\Users\Administrator\db_connection\sde@gisdb.dukcapil.kemendagri.go.id.sde'

class logProcess():
	def logging_process_info(message):
		time_obj = datetime.datetime.today()
		time_str = datetime.datetime.strftime(time_obj, "%d-%m-%Y %H:%M")
		concate_msg = "{} {}".format(time_str, message)
		arcpy.AddMessage(concate_msg)
		
	def logging_process_error(message):
		arcpy.AddMessage(message)
		
	def logging_process_warning(message):
		time_obj = datetime.datetime.today()
		time_str = datetime.datetime.strftime(time_obj, "%d-%m-%Y %H:%M")
		concate_msg = "{} {}".format(time_str, message)
		arcpy.AddMessage(concate_msg)
		
class uploadFile():
	def create_archiveTable():
		logProcess.logging_process_info("Uploading file...")
		upload_file = MyWatcher.run()
		print(upload_file)
		file_name = upload_file.split(sep='\\')[-1]
		table_name = file_name.split(sep='.')[0]
		arcpy.AddMessage(table_name)
		area_level = table_name.split(sep='_')[-2]
		arcpy.AddMessage(area_level)
		
		# Convert CSV to table
		logProcess.logging_process_info("Convert CSV to table...")
		if area_level == 'PROP':
			arcpy.conversion.TableToTable(upload_file, output_gdb, table_name, '', 'NO_PROP "NO_PROP" true true false 4 Long 0 0,First,#,upload_file,NO_PROP,-1,-1;NAMA_PROP "NAMA_PROP" true true false 8000 Text 0 0,First,#,upload_file,NAMA_PROP,0,8000;JUMLAH_KABUPATEN "JUMLAH_KABUPATEN" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_KABUPATEN,-1,-1;JUMLAH_KOTA "JUMLAH_KOTA" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_KOTA,-1,-1;JUMLAH_KECAMATAN "JUMLAH_KECAMATAN" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_KECAMATAN,-1,-1;JUMLAH_DESA "JUMLAH_DESA" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_DESA,-1,-1;JUMLAH_KELURAHAN "JUMLAH_KELURAHAN" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_KELURAHAN,-1,-1;JUMLAH_PENDUDUK "JUMLAH_PENDUDUK" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_PENDUDUK,-1,-1;JUMLAH_KK "JUMLAH_KK" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_KK,-1,-1;LUAS_WILAYAH "LUAS_WILAYAH" true true false 8 Double 0 0,First,#,upload_file,luas_wilayah,-1,-1;KEPADATAN_PENDUDUK "KEPADATAN_PENDUDUK" true true false 4 Long 0 0,First,#,upload_file,KEPADATAN_PENDUDUK,-1,-1;PERPINDAHAN_PDDK "PERPINDAHAN_PDDK" true true false 4 Long 0 0,First,#,upload_file,PERPINDAHAN_PDDK,-1,-1;JML_MENINGGAL "JML_MENINGGAL" true true false 4 Long 0 0,First,#,upload_file,JML_MENINGGAL,-1,-1;PERUBAHAN_DATA "PERUBAHAN_DATA" true true false 4 Long 0 0,First,#,upload_file,PERUBAHAN_DATA,-1,-1;JML_WKTP "JML_WKTP" true true false 4 Long 0 0,First,#,upload_file,JML_WKTP,-1,-1;JML_REKAM_WKTP "JML_REKAM_WKTP" true true false 4 Long 0 0,First,#,upload_file,JML_REKAM_WKTP,-1,-1;FIELD1 "FIELD1" true true false 8000 Text 0 0,First,#,upload_file,FIELD1,0,8000;FIELD2 "FIELD2" true true false 8000 Text 0 0,First,#,upload_file,FIELD2,0,8000;ISLAM "ISLAM" true true false 4 Long 0 0,First,#,upload_file,ISLAM,-1,-1;KRISTEN "KRISTEN" true true false 4 Long 0 0,First,#,upload_file,KRISTEN,-1,-1;KATHOLIK "KATHOLIK" true true false 4 Long 0 0,First,#,upload_file,KATHOLIK,-1,-1;HINDU "HINDU" true true false 4 Long 0 0,First,#,upload_file,HINDU,-1,-1;BUDHA "BUDHA" true true false 4 Long 0 0,First,#,upload_file,BUDHA,-1,-1;KONGHUCU "KONGHUCU" true true false 4 Long 0 0,First,#,upload_file,KONGHUCU,-1,-1;KEPERCAYAAN "KEPERCAYAAN" true true false 4 Long 0 0,First,#,upload_file,KEPERCAYAAN,-1,-1;FIELD3 "FIELD3" true true false 8000 Text 0 0,First,#,upload_file,FIELD3,0,8000;FIELD4 "FIELD4" true true false 8000 Text 0 0,First,#,upload_file,FIELD4,0,8000;PRIA "PRIA" true true false 4 Long 0 0,First,#,upload_file,PRIA,-1,-1;WANITA "WANITA" true true false 4 Long 0 0,First,#,upload_file,WANITA,-1,-1;FIELD5 "FIELD5" true true false 8000 Text 0 0,First,#,upload_file,FIELD5,0,8000;FIELD6 "FIELD6" true true false 8000 Text 0 0,First,#,upload_file,FIELD6,0,8000;BELUM_KAWIN "BELUM_KAWIN" true true false 4 Long 0 0,First,#,upload_file,BELUM_KAWIN,-1,-1;KAWIN "KAWIN" true true false 4 Long 0 0,First,#,upload_file,KAWIN,-1,-1;CERAI_HIDUP "CERAI_HIDUP" true true false 4 Long 0 0,First,#,upload_file,CERAI_HIDUP,-1,-1;CERAI_MATI "CERAI_MATI" true true false 4 Long 0 0,First,#,upload_file,CERAI_MATI,-1,-1;FIELD7 "FIELD7" true true false 8000 Text 0 0,First,#,upload_file,FIELD7,0,8000;FIELD8 "FIELD8" true true false 8000 Text 0 0,First,#,upload_file,FIELD8,0,8000;U0 "U0" true true false 4 Long 0 0,First,#,upload_file,U0,-1,-1;U5 "U5" true true false 4 Long 0 0,First,#,upload_file,U5,-1,-1;U10 "U10" true true false 4 Long 0 0,First,#,upload_file,U10,-1,-1;U15 "U15" true true false 4 Long 0 0,First,#,upload_file,U15,-1,-1;U20 "U20" true true false 4 Long 0 0,First,#,upload_file,U20,-1,-1;U25 "U25" true true false 4 Long 0 0,First,#,upload_file,U25,-1,-1;U30 "U30" true true false 4 Long 0 0,First,#,upload_file,U30,-1,-1;U35 "U35" true true false 4 Long 0 0,First,#,upload_file,U35,-1,-1;U40 "U40" true true false 4 Long 0 0,First,#,upload_file,U40,-1,-1;U45 "U45" true true false 4 Long 0 0,First,#,upload_file,U45,-1,-1;U50 "U50" true true false 4 Long 0 0,First,#,upload_file,U50,-1,-1;U55 "U55" true true false 4 Long 0 0,First,#,upload_file,U55,-1,-1;U60 "U60" true true false 4 Long 0 0,First,#,upload_file,U60,-1,-1;U65 "U65" true true false 4 Long 0 0,First,#,upload_file,U65,-1,-1;U70 "U70" true true false 4 Long 0 0,First,#,upload_file,U70,-1,-1;U75 "U75" true true false 4 Long 0 0,First,#,upload_file,U75,-1,-1;FIELD9 "FIELD9" true true false 8000 Text 0 0,First,#,upload_file,FIELD9,0,8000;FIELD10 "FIELD10" true true false 8000 Text 0 0,First,#,upload_file,FIELD10,0,8000;LHR_2018 "LHR_2018" true true false 4 Long 0 0,First,#,upload_file,LHR_2018,-1,-1;LHR_SEBELUM_2018 "LHR_SEBELUM_2018" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2018,-1,-1;LHR_2019 "LHR_2019" true true false 4 Long 0 0,First,#,upload_file,LHR_2019,-1,-1;LHR_SEBELUM_2019 "LHR_SEBELUM_2019" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2019,-1,-1;LHR_2020 "LHR_2020" true true false 4 Long 0 0,First,#,upload_file,LHR_2020,-1,-1;LHR_SEBELUM_2020 "LHR_SEBELUM_2020" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2020,-1,-1;LHR_2021 "LHR_2021" true true false 4 Long 0 0,First,#,upload_file,LHR_2021,-1,-1;LHR_SEBELUM_2021 "LHR_SEBELUM_2021" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2021,-1,-1;LHR_2022 "LHR_2022" true true false 4 Long 0 0,First,#,upload_file,LHR_2022,-1,-1;LHR_SEBELUM_2022 "LHR_SEBELUM_2022" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2022,-1,-1;PERTUMBUHAN_2018 "PERTUMBUHAN_2018" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2018,-1,-1;PERTUMBUHAN_2019 "PERTUMBUHAN_2019" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2019,-1,-1;PERTUMBUHAN_2020 "PERTUMBUHAN_2020" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2020,-1,-1;PERTUMBUHAN_2021 "PERTUMBUHAN_2021" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2021,-1,-1;PERTUMBUHAN_2022 "PERTUMBUHAN_2022" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2022,-1,-1;FIELD11 "FIELD11" true true false 8000 Text 0 0,First,#,upload_file,FIELD11,0,8000;FIELD12 "FIELD12" true true false 8000 Text 0 0,First,#,upload_file,FIELD12,0,8000;USIA_SEKOLAH5_6 "USIA_SEKOLAH5_6" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH5_6,-1,-1;USIA_SEKOLAH7_12 "USIA_SEKOLAH7_12" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH7_12,-1,-1;USIA_SEKOLAH12_15 "USIA_SEKOLAH12_15" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH12_15,-1,-1;USIA_SEKOLAH16_18 "USIA_SEKOLAH16_18" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH16_18,-1,-1;FIELD13 "FIELD13" true true false 8000 Text 0 0,First,#,upload_file,FIELD13,0,8000;FIELD14 "FIELD14" true true false 8000 Text 0 0,First,#,upload_file,FIELD14,0,8000;TIDAK_BLM_SEKOLAH "TIDAK_BLM_SEKOLAH" true true false 4 Long 0 0,First,#,upload_file,TIDAK_BLM_SEKOLAH,-1,-1;BELUM_TAMAT_SD "BELUM_TAMAT_SD" true true false 4 Long 0 0,First,#,upload_file,BELUM_TAMAT_SD,-1,-1;TAMAT_SD "TAMAT_SD" true true false 4 Long 0 0,First,#,upload_file,TAMAT_SD,-1,-1;SLTP "SLTP" true true false 4 Long 0 0,First,#,upload_file,SLTP,-1,-1;SLTA "SLTA" true true false 4 Long 0 0,First,#,upload_file,SLTA,-1,-1;D1_DAN_D2 "D1_DAN_D2" true true false 4 Long 0 0,First,#,upload_file,D1_DAN_D2,-1,-1;D3 "D3" true true false 4 Long 0 0,First,#,upload_file,D3,-1,-1;S1 "S1" true true false 4 Long 0 0,First,#,upload_file,S1,-1,-1;S2 "S2" true true false 4 Long 0 0,First,#,upload_file,S2,-1,-1;S3 "S3" true true false 4 Long 0 0,First,#,upload_file,S3,-1,-1;FIELD15 "FIELD15" true true false 8000 Text 0 0,First,#,upload_file,FIELD15,0,8000;FIELD16 "FIELD16" true true false 8000 Text 0 0,First,#,upload_file,FIELD16,0,8000;O "O" true true false 4 Long 0 0,First,#,upload_file,O,-1,-1;B- "B-" true true false 4 Long 0 0,First,#,upload_file,B-,-1,-1;B+ "B+" true true false 4 Long 0 0,First,#,upload_file,B+,-1,-1;O+ "O+" true true false 4 Long 0 0,First,#,upload_file,O+,-1,-1;AB- "AB-" true true false 4 Long 0 0,First,#,upload_file,AB-,-1,-1;A "A" true true false 4 Long 0 0,First,#,upload_file,A,-1,-1;TIDAK_TAHU "TIDAK_TAHU" true true false 4 Long 0 0,First,#,upload_file,TIDAK_TAHU,-1,-1;AB+ "AB+" true true false 4 Long 0 0,First,#,upload_file,AB+,-1,-1;A+ "A+" true true false 4 Long 0 0,First,#,upload_file,A+,-1,-1;A- "A-" true true false 4 Long 0 0,First,#,upload_file,A-,-1,-1;O- "O-" true true false 4 Long 0 0,First,#,upload_file,O-,-1,-1;B "B" true true false 4 Long 0 0,First,#,upload_file,B,-1,-1;AB "AB" true true false 4 Long 0 0,First,#,upload_file,AB,-1,-1;FIELD17 "FIELD17" true true false 8000 Text 0 0,First,#,upload_file,FIELD17,0,8000;FIELD18 "FIELD18" true true false 8000 Text 0 0,First,#,upload_file,FIELD18,0,8000;PENSIUNAN "PENSIUNAN" true true false 4 Long 0 0,First,#,upload_file,PENSIUNAN,-1,-1;MENGURUS_RUMAH_TANGGA "MENGURUS_RUMAH_TANGGA" true true false 4 Long 0 0,First,#,upload_file,MENGURUS_RUMAH_TANGGA,-1,-1;BELUM_TIDAK_BEKERJA "BELUM_TIDAK_BEKERJA" true true false 4 Long 0 0,First,#,upload_file,BELUM_TIDAK_BEKERJA,-1,-1;LAINNYA "LAINNYA" true true false 4 Long 0 0,First,#,upload_file,LAINNYA,-1,-1;PERDAGANGAN "PERDAGANGAN" true true false 4 Long 0 0,First,#,upload_file,PERDAGANGAN,-1,-1;PERAWAT "PERAWAT" true true false 4 Long 0 0,First,#,upload_file,PERAWAT,-1,-1;NELAYAN "NELAYAN" true true false 4 Long 0 0,First,#,upload_file,NELAYAN,-1,-1;PELAJAR_MAHASISWA "PELAJAR_MAHASISWA" true true false 4 Long 0 0,First,#,upload_file,PELAJAR_MAHASISWA,-1,-1;GURU "GURU" true true false 4 Long 0 0,First,#,upload_file,GURU,-1,-1;WIRASWASTA "WIRASWASTA" true true false 4 Long 0 0,First,#,upload_file,WIRASWASTA,-1,-1;PENGACARA "PENGACARA" true true false 4 Long 0 0,First,#,upload_file,PENGACARA,-1,-1;FIELD19 "FIELD19" true true false 8000 Text 0 0,First,#,upload_file,FIELD19,0,8000;FIELD20 "FIELD20" true true false 8000 Text 0 0,First,#,upload_file,FIELD20,0,8000', '')
			
			logProcess.logging_process_info('Success to convert {} table.'.format(table_name))
			
		elif area_level == 'KAB':
			arcpy.conversion.TableToTable(upload_file, output_gdb, table_name, '', 'NO_PROP "NO_PROP" true true false 4 Long 0 0,First,#,upload_file,NO_PROP,-1,-1;NO_KAB "NO_KAB" true true false 4 Long 0 0,First,#,upload_file,NO_KAB,-1,-1;KODE_PROP_SPATIAL "KODE_PROP_SPATIAL" true true false 4 Long 0 0,First,#,upload_file,KODE_PROP_SPATIAL,-1,-1;KODE_KAB_SPATIAL "KODE_KAB_SPATIAL" true true false 4 Long 0 0,First,#,upload_file,KODE_KAB_SPATIAL,-1,-1;JUMLAH_DESA "JUMLAH_DESA" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_DESA,-1,-1;JUMLAH_KELURAHAN "JUMLAH_KELURAHAN" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_KELURAHAN,-1,-1;NAMA_PROP "NAMA_PROP" true true false 8000 Text 0 0,First,#,upload_file,NAMA_PROP,0,8000;NAMA_KAB "NAMA_KAB" true true false 8000 Text 0 0,First,#,upload_file,NAMA_KAB,0,8000;JUMLAH_KECAMATAN "JUMLAH_KECAMATAN" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_KECAMATAN,-1,-1;JUMLAH_PENDUDUK "JUMLAH_PENDUDUK" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_PENDUDUK,-1,-1;JUMLAH_KK "JUMLAH_KK" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_KK,-1,-1;LUAS_WILAYAH "LUAS_WILAYAH" true true false 8 Double 0 0,First,#,upload_file,luas_wilayah,-1,-1;KEPADATAN_PENDUDUK "KEPADATAN_PENDUDUK" true true false 4 Long 0 0,First,#,upload_file,KEPADATAN_PENDUDUK,-1,-1;PERPINDAHAN_PDDK "PERPINDAHAN_PDDK" true true false 4 Long 0 0,First,#,upload_file,PERPINDAHAN_PDDK,-1,-1;JML_MENINGGAL "JML_MENINGGAL" true true false 4 Long 0 0,First,#,upload_file,JML_MENINGGAL,-1,-1;PERUBAHAN_DATA "PERUBAHAN_DATA" true true false 4 Long 0 0,First,#,upload_file,PERUBAHAN_DATA,-1,-1;JML_WKTP "JML_WKTP" true true false 4 Long 0 0,First,#,upload_file,JML_WKTP,-1,-1;JML_REKAM_WKTP "JML_REKAM_WKTP" true true false 4 Long 0 0,First,#,upload_file,JML_REKAM_WKTP,-1,-1;FIELD1 "FIELD1" true true false 8000 Text 0 0,First,#,upload_file,FIELD1,0,8000;FIELD2 "FIELD2" true true false 8000 Text 0 0,First,#,upload_file,FIELD2,0,8000;ISLAM "ISLAM" true true false 4 Long 0 0,First,#,upload_file,ISLAM,-1,-1;KRISTEN "KRISTEN" true true false 4 Long 0 0,First,#,upload_file,KRISTEN,-1,-1;KATHOLIK "KATHOLIK" true true false 4 Long 0 0,First,#,upload_file,KATHOLIK,-1,-1;HINDU "HINDU" true true false 4 Long 0 0,First,#,upload_file,HINDU,-1,-1;BUDHA "BUDHA" true true false 4 Long 0 0,First,#,upload_file,BUDHA,-1,-1;KONGHUCU "KONGHUCU" true true false 4 Long 0 0,First,#,upload_file,KONGHUCU,-1,-1;KEPERCAYAAN "KEPERCAYAAN" true true false 4 Long 0 0,First,#,upload_file,KEPERCAYAAN,-1,-1;FIELD3 "FIELD3" true true false 8000 Text 0 0,First,#,upload_file,FIELD3,0,8000;FIELD4 "FIELD4" true true false 8000 Text 0 0,First,#,upload_file,FIELD4,0,8000;PRIA "PRIA" true true false 4 Long 0 0,First,#,upload_file,PRIA,-1,-1;WANITA "WANITA" true true false 4 Long 0 0,First,#,upload_file,WANITA,-1,-1;FIELD5 "FIELD5" true true false 8000 Text 0 0,First,#,upload_file,FIELD5,0,8000;FIELD6 "FIELD6" true true false 8000 Text 0 0,First,#,upload_file,FIELD6,0,8000;BELUM_KAWIN "BELUM_KAWIN" true true false 4 Long 0 0,First,#,upload_file,BELUM_KAWIN,-1,-1;KAWIN "KAWIN" true true false 4 Long 0 0,First,#,upload_file,KAWIN,-1,-1;CERAI_HIDUP "CERAI_HIDUP" true true false 4 Long 0 0,First,#,upload_file,CERAI_HIDUP,-1,-1;CERAI_MATI "CERAI_MATI" true true false 4 Long 0 0,First,#,upload_file,CERAI_MATI,-1,-1;FIELD7 "FIELD7" true true false 8000 Text 0 0,First,#,upload_file,FIELD7,0,8000;FIELD8 "FIELD8" true true false 8000 Text 0 0,First,#,upload_file,FIELD8,0,8000;U0 "U0" true true false 4 Long 0 0,First,#,upload_file,U0,-1,-1;U5 "U5" true true false 4 Long 0 0,First,#,upload_file,U5,-1,-1;U10 "U10" true true false 4 Long 0 0,First,#,upload_file,U10,-1,-1;U15 "U15" true true false 4 Long 0 0,First,#,upload_file,U15,-1,-1;U20 "U20" true true false 4 Long 0 0,First,#,upload_file,U20,-1,-1;U25 "U25" true true false 4 Long 0 0,First,#,upload_file,U25,-1,-1;U30 "U30" true true false 4 Long 0 0,First,#,upload_file,U30,-1,-1;U35 "U35" true true false 4 Long 0 0,First,#,upload_file,U35,-1,-1;U40 "U40" true true false 4 Long 0 0,First,#,upload_file,U40,-1,-1;U45 "U45" true true false 4 Long 0 0,First,#,upload_file,U45,-1,-1;U50 "U50" true true false 4 Long 0 0,First,#,upload_file,U50,-1,-1;U55 "U55" true true false 4 Long 0 0,First,#,upload_file,U55,-1,-1;U60 "U60" true true false 4 Long 0 0,First,#,upload_file,U60,-1,-1;U65 "U65" true true false 4 Long 0 0,First,#,upload_file,U65,-1,-1;U70 "U70" true true false 4 Long 0 0,First,#,upload_file,U70,-1,-1;U75 "U75" true true false 4 Long 0 0,First,#,upload_file,U75,-1,-1;FIELD9 "FIELD9" true true false 8000 Text 0 0,First,#,upload_file,FIELD9,0,8000;FIELD10 "FIELD10" true true false 8000 Text 0 0,First,#,upload_file,FIELD10,0,8000;LHR_2018 "LHR_2018" true true false 4 Long 0 0,First,#,upload_file,LHR_2018,-1,-1;LHR_SEBELUM_2018 "LHR_SEBELUM_2018" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2018,-1,-1;LHR_2019 "LHR_2019" true true false 4 Long 0 0,First,#,upload_file,LHR_2019,-1,-1;LHR_SEBELUM_2019 "LHR_SEBELUM_2019" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2019,-1,-1;LHR_2020 "LHR_2020" true true false 4 Long 0 0,First,#,upload_file,LHR_2020,-1,-1;LHR_SEBELUM_2020 "LHR_SEBELUM_2020" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2020,-1,-1;LHR_2021 "LHR_2021" true true false 4 Long 0 0,First,#,upload_file,LHR_2021,-1,-1;LHR_SEBELUM_2021 "LHR_SEBELUM_2021" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2021,-1,-1;LHR_2022 "LHR_2022" true true false 4 Long 0 0,First,#,upload_file,LHR_2022,-1,-1;LHR_SEBELUM_2022 "LHR_SEBELUM_2022" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2022,-1,-1;PERTUMBUHAN_2018 "PERTUMBUHAN_2018" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2018,-1,-1;PERTUMBUHAN_2019 "PERTUMBUHAN_2019" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2019,-1,-1;PERTUMBUHAN_2020 "PERTUMBUHAN_2020" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2020,-1,-1;PERTUMBUHAN_2021 "PERTUMBUHAN_2021" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2021,-1,-1;PERTUMBUHAN_2022 "PERTUMBUHAN_2022" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2022,-1,-1;FIELD11 "FIELD11" true true false 8000 Text 0 0,First,#,upload_file,FIELD11,0,8000;FIELD12 "FIELD12" true true false 8000 Text 0 0,First,#,upload_file,FIELD12,0,8000;USIA_SEKOLAH5_6 "USIA_SEKOLAH5_6" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH5_6,-1,-1;USIA_SEKOLAH7_12 "USIA_SEKOLAH7_12" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH7_12,-1,-1;USIA_SEKOLAH12_15 "USIA_SEKOLAH12_15" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH12_15,-1,-1;USIA_SEKOLAH16_18 "USIA_SEKOLAH16_18" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH16_18,-1,-1;FIELD13 "FIELD13" true true false 8000 Text 0 0,First,#,upload_file,FIELD13,0,8000;FIELD14 "FIELD14" true true false 8000 Text 0 0,First,#,upload_file,FIELD14,0,8000;TIDAK_BLM_SEKOLAH "TIDAK_BLM_SEKOLAH" true true false 4 Long 0 0,First,#,upload_file,TIDAK_BLM_SEKOLAH,-1,-1;BELUM_TAMAT_SD "BELUM_TAMAT_SD" true true false 4 Long 0 0,First,#,upload_file,BELUM_TAMAT_SD,-1,-1;TAMAT_SD "TAMAT_SD" true true false 4 Long 0 0,First,#,upload_file,TAMAT_SD,-1,-1;SLTP "SLTP" true true false 4 Long 0 0,First,#,upload_file,SLTP,-1,-1;SLTA "SLTA" true true false 4 Long 0 0,First,#,upload_file,SLTA,-1,-1;D1_DAN_D2 "D1_DAN_D2" true true false 4 Long 0 0,First,#,upload_file,D1_DAN_D2,-1,-1;D3 "D3" true true false 4 Long 0 0,First,#,upload_file,D3,-1,-1;S1 "S1" true true false 4 Long 0 0,First,#,upload_file,S1,-1,-1;S2 "S2" true true false 4 Long 0 0,First,#,upload_file,S2,-1,-1;S3 "S3" true true false 4 Long 0 0,First,#,upload_file,S3,-1,-1;FIELD15 "FIELD15" true true false 8000 Text 0 0,First,#,upload_file,FIELD15,0,8000;FIELD16 "FIELD16" true true false 8000 Text 0 0,First,#,upload_file,FIELD16,0,8000;O "O" true true false 4 Long 0 0,First,#,upload_file,O,-1,-1;B- "B-" true true false 4 Long 0 0,First,#,upload_file,B-,-1,-1;B+ "B+" true true false 4 Long 0 0,First,#,upload_file,B+,-1,-1;O+ "O+" true true false 4 Long 0 0,First,#,upload_file,O+,-1,-1;AB- "AB-" true true false 4 Long 0 0,First,#,upload_file,AB-,-1,-1;A "A" true true false 4 Long 0 0,First,#,upload_file,A,-1,-1;TIDAK_TAHU "TIDAK_TAHU" true true false 4 Long 0 0,First,#,upload_file,TIDAK_TAHU,-1,-1;AB+ "AB+" true true false 4 Long 0 0,First,#,upload_file,AB+,-1,-1;A+ "A+" true true false 4 Long 0 0,First,#,upload_file,A+,-1,-1;A- "A-" true true false 4 Long 0 0,First,#,upload_file,A-,-1,-1;O- "O-" true true false 4 Long 0 0,First,#,upload_file,O-,-1,-1;B "B" true true false 4 Long 0 0,First,#,upload_file,B,-1,-1;AB "AB" true true false 4 Long 0 0,First,#,upload_file,AB,-1,-1;FIELD17 "FIELD17" true true false 8000 Text 0 0,First,#,upload_file,FIELD17,0,8000;FIELD18 "FIELD18" true true false 8000 Text 0 0,First,#,upload_file,FIELD18,0,8000;PENSIUNAN "PENSIUNAN" true true false 4 Long 0 0,First,#,upload_file,PENSIUNAN,-1,-1;MENGURUS_RUMAH_TANGGA "MENGURUS_RUMAH_TANGGA" true true false 4 Long 0 0,First,#,upload_file,MENGURUS_RUMAH_TANGGA,-1,-1;BELUM_TIDAK_BEKERJA "BELUM_TIDAK_BEKERJA" true true false 4 Long 0 0,First,#,upload_file,BELUM_TIDAK_BEKERJA,-1,-1;LAINNYA "LAINNYA" true true false 4 Long 0 0,First,#,upload_file,LAINNYA,-1,-1;PERDAGANGAN "PERDAGANGAN" true true false 4 Long 0 0,First,#,upload_file,PERDAGANGAN,-1,-1;PERAWAT "PERAWAT" true true false 4 Long 0 0,First,#,upload_file,PERAWAT,-1,-1;NELAYAN "NELAYAN" true true false 4 Long 0 0,First,#,upload_file,NELAYAN,-1,-1;PELAJAR_MAHASISWA "PELAJAR_MAHASISWA" true true false 4 Long 0 0,First,#,upload_file,PELAJAR_MAHASISWA,-1,-1;GURU "GURU" true true false 4 Long 0 0,First,#,upload_file,GURU,-1,-1;WIRASWASTA "WIRASWASTA" true true false 4 Long 0 0,First,#,upload_file,WIRASWASTA,-1,-1;PENGACARA "PENGACARA" true true false 4 Long 0 0,First,#,upload_file,PENGACARA,-1,-1;FIELD19 "FIELD19" true true false 8000 Text 0 0,First,#,upload_file,FIELD19,0,8000;FIELD20 "FIELD20" true true false 8000 Text 0 0,First,#,upload_file,FIELD20,0,8000', '')
			
			logProcess.logging_process_info('Success to convert {} table.'.format(table_name))
			
		elif area_level == 'KEC':
			arcpy.conversion.TableToTable(upload_file, output_gdb, table_name, '', 'NO_PROP "NO_PROP" true true false 4 Long 0 0,First,#,upload_file,NO_PROP,-1,-1;NO_KAB "NO_KAB" true true false 4 Long 0 0,First,#,upload_file,NO_KAB,-1,-1;NO_KEC "NO_KEC" true true false 4 Long 0 0,First,#,upload_file,NO_KEC,-1,-1;KODE_PROP_SPATIAL "KODE_PROP_SPATIAL" true true false 4 Long 0 0,First,#,upload_file,KODE_PROP_SPATIAL,-1,-1;KODE_KAB_SPATIAL "KODE_KAB_SPATIAL" true true false 4 Long 0 0,First,#,upload_file,KODE_KAB_SPATIAL,-1,-1;KODE_KEC_SPATIAL "KODE_KEC_SPATIAL" true true false 4 Long 0 0,First,#,upload_file,KODE_KEC_SPATIAL,-1,-1;NAMA_PROP "NAMA_PROP" true true false 8000 Text 0 0,First,#,upload_file,NAMA_PROP,0,8000;NAMA_KAB "NAMA_KAB" true true false 8000 Text 0 0,First,#,upload_file,NAMA_KAB,0,8000;NAMA_KEC "NAMA_KEC" true true false 8000 Text 0 0,First,#,upload_file,NAMA_KEC,0,8000;JUMLAH_DESA "JUMLAH_DESA" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_DESA,-1,-1;JUMLAH_KELURAHAN "JUMLAH_KELURAHAN" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_KELURAHAN,-1,-1;JUMLAH_PENDUDUK "JUMLAH_PENDUDUK" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_PENDUDUK,-1,-1;JUMLAH_KK "JUMLAH_KK" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_KK,-1,-1;LUAS_WILAYAH "LUAS_WILAYAH" true true false 8 Double 0 0,First,#,upload_file,LUAS_WILAYAH,-1,-1;KEPADATAN_PENDUDUK "KEPADATAN_PENDUDUK" true true false 8 Double 0 0,First,#,upload_file,KEPADATAN_PENDUDUK,-1,-1;PERPINDAHAN_PDDK "PERPINDAHAN_PDDK" true true false 4 Long 0 0,First,#,upload_file,PERPINDAHAN_PDDK,-1,-1;JML_MENINGGAL "JML_MENINGGAL" true true false 4 Long 0 0,First,#,upload_file,JML_MENINGGAL,-1,-1;PERUBAHAN_DATA "PERUBAHAN_DATA" true true false 4 Long 0 0,First,#,upload_file,PERUBAHAN_DATA,-1,-1;JML_WKTP "JML_WKTP" true true false 4 Long 0 0,First,#,upload_file,JML_WKTP,-1,-1;JML_REKAM_WKTP "JML_REKAM_WKTP" true true false 4 Long 0 0,First,#,upload_file,JML_REKAM_WKTP,-1,-1;FIELD1 "FIELD1" true true false 8000 Text 0 0,First,#,upload_file,FIELD1,0,8000;FIELD2 "FIELD2" true true false 8000 Text 0 0,First,#,upload_file,FIELD2,0,8000;ISLAM "ISLAM" true true false 4 Long 0 0,First,#,upload_file,ISLAM,-1,-1;KRISTEN "KRISTEN" true true false 4 Long 0 0,First,#,upload_file,KRISTEN,-1,-1;KATHOLIK "KATHOLIK" true true false 4 Long 0 0,First,#,upload_file,KATHOLIK,-1,-1;HINDU "HINDU" true true false 4 Long 0 0,First,#,upload_file,HINDU,-1,-1;BUDHA "BUDHA" true true false 4 Long 0 0,First,#,upload_file,BUDHA,-1,-1;KONGHUCU "KONGHUCU" true true false 4 Long 0 0,First,#,upload_file,KONGHUCU,-1,-1;KEPERCAYAAN "KEPERCAYAAN" true true false 4 Long 0 0,First,#,upload_file,KEPERCAYAAN,-1,-1;FIELD3 "FIELD3" true true false 8000 Text 0 0,First,#,upload_file,FIELD3,0,8000;FIELD4 "FIELD4" true true false 8000 Text 0 0,First,#,upload_file,FIELD4,0,8000;PRIA "PRIA" true true false 4 Long 0 0,First,#,upload_file,PRIA,-1,-1;WANITA "WANITA" true true false 4 Long 0 0,First,#,upload_file,WANITA,-1,-1;FIELD5 "FIELD5" true true false 8000 Text 0 0,First,#,upload_file,FIELD5,0,8000;FIELD6 "FIELD6" true true false 8000 Text 0 0,First,#,upload_file,FIELD6,0,8000;KAWIN "KAWIN" true true false 4 Long 0 0,First,#,upload_file,KAWIN,-1,-1;BELUM_KAWIN "BELUM_KAWIN" true true false 4 Long 0 0,First,#,upload_file,BELUM_KAWIN,-1,-1;CERAI_HIDUP "CERAI_HIDUP" true true false 4 Long 0 0,First,#,upload_file,CERAI_HIDUP,-1,-1;CERAI_MATI "CERAI_MATI" true true false 4 Long 0 0,First,#,upload_file,CERAI_MATI,-1,-1;FIELD7 "FIELD7" true true false 8000 Text 0 0,First,#,upload_file,FIELD7,0,8000;FIELD8 "FIELD8" true true false 8000 Text 0 0,First,#,upload_file,FIELD8,0,8000;U0 "U0" true true false 4 Long 0 0,First,#,upload_file,U0,-1,-1;U5 "U5" true true false 4 Long 0 0,First,#,upload_file,U5,-1,-1;U10 "U10" true true false 4 Long 0 0,First,#,upload_file,U10,-1,-1;U15 "U15" true true false 4 Long 0 0,First,#,upload_file,U15,-1,-1;U20 "U20" true true false 4 Long 0 0,First,#,upload_file,U20,-1,-1;U25 "U25" true true false 4 Long 0 0,First,#,upload_file,U25,-1,-1;U30 "U30" true true false 4 Long 0 0,First,#,upload_file,U30,-1,-1;U35 "U35" true true false 4 Long 0 0,First,#,upload_file,U35,-1,-1;U40 "U40" true true false 4 Long 0 0,First,#,upload_file,U40,-1,-1;U45 "U45" true true false 4 Long 0 0,First,#,upload_file,U45,-1,-1;U50 "U50" true true false 4 Long 0 0,First,#,upload_file,U50,-1,-1;U55 "U55" true true false 4 Long 0 0,First,#,upload_file,U55,-1,-1;U60 "U60" true true false 4 Long 0 0,First,#,upload_file,U60,-1,-1;U65 "U65" true true false 4 Long 0 0,First,#,upload_file,U65,-1,-1;U70 "U70" true true false 4 Long 0 0,First,#,upload_file,U70,-1,-1;U75 "U75" true true false 4 Long 0 0,First,#,upload_file,U75,-1,-1;FIELD9 "FIELD9" true true false 8000 Text 0 0,First,#,upload_file,FIELD9,0,8000;FIELD10 "FIELD10" true true false 8000 Text 0 0,First,#,upload_file,FIELD10,0,8000;LHR_2018 "LHR_2018" true true false 4 Long 0 0,First,#,upload_file,LHR_2018,-1,-1;LHR_SEBELUM_2018 "LHR_SEBELUM_2018" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2018,-1,-1;LHR_2019 "LHR_2019" true true false 4 Long 0 0,First,#,upload_file,LHR_2019,-1,-1;LHR_SEBELUM_2019 "LHR_SEBELUM_2019" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2019,-1,-1;LHR_2020 "LHR_2020" true true false 4 Long 0 0,First,#,upload_file,LHR_2020,-1,-1;LHR_SEBELUM_2020 "LHR_SEBELUM_2020" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2020,-1,-1;LHR_2021 "LHR_2021" true true false 4 Long 0 0,First,#,upload_file,LHR_2021,-1,-1;LHR_SEBELUM_2021 "LHR_SEBELUM_2021" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2021,-1,-1;LHR_2022 "LHR_2022" true true false 4 Long 0 0,First,#,upload_file,LHR_2022,-1,-1;LHR_SEBELUM_2022 "LHR_SEBELUM_2022" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2022,-1,-1;PERTUMBUHAN_2018 "PERTUMBUHAN_2018" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2018,-1,-1;PERTUMBUHAN_2019 "PERTUMBUHAN_2019" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2019,-1,-1;PERTUMBUHAN_2020 "PERTUMBUHAN_2020" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2020,-1,-1;PERTUMBUHAN_2021 "PERTUMBUHAN_2021" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2021,-1,-1;PERTUMBUHAN_2022 "PERTUMBUHAN_2022" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2022,-1,-1;FIELD11 "FIELD11" true true false 8000 Text 0 0,First,#,upload_file,FIELD11,0,8000;FIELD12 "FIELD12" true true false 8000 Text 0 0,First,#,upload_file,FIELD12,0,8000;USIA_SEKOLAH5_6 "USIA_SEKOLAH5_6" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH5_6,-1,-1;USIA_SEKOLAH7_12 "USIA_SEKOLAH7_12" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH7_12,-1,-1;USIA_SEKOLAH12_15 "USIA_SEKOLAH12_15" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH12_15,-1,-1;USIA_SEKOLAH16_18 "USIA_SEKOLAH16_18" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH16_18,-1,-1;FIELD13 "FIELD13" true true false 8000 Text 0 0,First,#,upload_file,FIELD13,0,8000;FIELD14 "FIELD14" true true false 8000 Text 0 0,First,#,upload_file,FIELD14,0,8000;TIDAK_BLM_SEKOLAH "TIDAK_BLM_SEKOLAH" true true false 4 Long 0 0,First,#,upload_file,TIDAK_BLM_SEKOLAH,-1,-1;BELUM_TAMAT_SD "BELUM_TAMAT_SD" true true false 4 Long 0 0,First,#,upload_file,BELUM_TAMAT_SD,-1,-1;TAMAT_SD "TAMAT_SD" true true false 4 Long 0 0,First,#,upload_file,TAMAT_SD,-1,-1;SLTP "SLTP" true true false 4 Long 0 0,First,#,upload_file,SLTP,-1,-1;SLTA "SLTA" true true false 4 Long 0 0,First,#,upload_file,SLTA,-1,-1;D1_DAN_D2 "D1_DAN_D2" true true false 4 Long 0 0,First,#,upload_file,D1_DAN_D2,-1,-1;D3 "D3" true true false 4 Long 0 0,First,#,upload_file,D3,-1,-1;S1 "S1" true true false 4 Long 0 0,First,#,upload_file,S1,-1,-1;S2 "S2" true true false 4 Long 0 0,First,#,upload_file,S2,-1,-1;S3 "S3" true true false 4 Long 0 0,First,#,upload_file,S3,-1,-1;FIELD15 "FIELD15" true true false 8000 Text 0 0,First,#,upload_file,FIELD15,0,8000;FIELD16 "FIELD16" true true false 8000 Text 0 0,First,#,upload_file,FIELD16,0,8000;O "O" true true false 4 Long 0 0,First,#,upload_file,O,-1,-1;B- "B-" true true false 4 Long 0 0,First,#,upload_file,B-,-1,-1;B+ "B+" true true false 4 Long 0 0,First,#,upload_file,B+,-1,-1;O+ "O+" true true false 4 Long 0 0,First,#,upload_file,O+,-1,-1;AB- "AB-" true true false 4 Long 0 0,First,#,upload_file,AB-,-1,-1;A "A" true true false 4 Long 0 0,First,#,upload_file,A,-1,-1;TIDAK_TAHU "TIDAK_TAHU" true true false 4 Long 0 0,First,#,upload_file,TIDAK_TAHU,-1,-1;AB+ "AB+" true true false 4 Long 0 0,First,#,upload_file,AB+,-1,-1;A+ "A+" true true false 4 Long 0 0,First,#,upload_file,A+,-1,-1;A- "A-" true true false 4 Long 0 0,First,#,upload_file,A-,-1,-1;O- "O-" true true false 4 Long 0 0,First,#,upload_file,O-,-1,-1;B "B" true true false 4 Long 0 0,First,#,upload_file,B,-1,-1;AB "AB" true true false 4 Long 0 0,First,#,upload_file,AB,-1,-1;FIELD17 "FIELD17" true true false 8000 Text 0 0,First,#,upload_file,FIELD17,0,8000;FIELD18 "FIELD18" true true false 8000 Text 0 0,First,#,upload_file,FIELD18,0,8000;PENSIUNAN "PENSIUNAN" true true false 4 Long 0 0,First,#,upload_file,PENSIUNAN,-1,-1;MENGURUS_RUMAH_TANGGA "MENGURUS_RUMAH_TANGGA" true true false 4 Long 0 0,First,#,upload_file,MENGURUS_RUMAH_TANGGA,-1,-1;BELUM_TIDAK_BEKERJA "BELUM_TIDAK_BEKERJA" true true false 4 Long 0 0,First,#,upload_file,BELUM_TIDAK_BEKERJA,-1,-1;LAINNYA "LAINNYA" true true false 4 Long 0 0,First,#,upload_file,LAINNYA,-1,-1;PERDAGANGAN "PERDAGANGAN" true true false 4 Long 0 0,First,#,upload_file,PERDAGANGAN,-1,-1;PERAWAT "PERAWAT" true true false 4 Long 0 0,First,#,upload_file,PERAWAT,-1,-1;NELAYAN "NELAYAN" true true false 4 Long 0 0,First,#,upload_file,NELAYAN,-1,-1;PELAJAR_MAHASISWA "PELAJAR_MAHASISWA" true true false 4 Long 0 0,First,#,upload_file,PELAJAR_MAHASISWA,-1,-1;GURU "GURU" true true false 4 Long 0 0,First,#,upload_file,GURU,-1,-1;WIRASWASTA "WIRASWASTA" true true false 4 Long 0 0,First,#,upload_file,WIRASWASTA,-1,-1;PENGACARA "PENGACARA" true true false 4 Long 0 0,First,#,upload_file,PENGACARA,-1,-1;FIELD19 "FIELD19" true true false 8000 Text 0 0,First,#,upload_file,FIELD19,0,8000;FIELD20 "FIELD20" true true false 8000 Text 0 0,First,#,upload_file,FIELD20,0,8000', '')
			
			logProcess.logging_process_info('Success to convert {} table.'.format(table_name))
			
		else:
			arcpy.conversion.TableToTable(upload_file, output_gdb, table_name, '', 'NO_PROP "NO_PROP" true true false 4 Long 0 0,First,#,upload_file,NO_PROP,-1,-1;NO_KAB "NO_KAB" true true false 4 Long 0 0,First,#,upload_file,NO_KAB,-1,-1;NO_KEC "NO_KEC" true true false 4 Long 0 0,First,#,upload_file,NO_KEC,-1,-1;NO_KEL "NO_KEL" true true false 4 Long 0 0,First,#,upload_file,NO_KEL,-1,-1;KODE_DESA_SPATIAL "KODE_DESA_SPATIAL" true true false 8 Double 0 0,First,#,upload_file,KODE_DESA_SPATIAL,-1,-1;NAMA_PROP "NAMA_PROP" true true false 8000 Text 0 0,First,#,upload_file,NAMA_PROP,0,8000;NAMA_KAB "NAMA_KAB" true true false 8000 Text 0 0,First,#,upload_file,NAMA_KAB,0,8000;NAMA_KEC "NAMA_KEC" true true false 8000 Text 0 0,First,#,upload_file,NAMA_KEC,0,8000;NAMA_KEL "NAMA_KEL" true true false 8000 Text 0 0,First,#,upload_file,NAMA_KEL,0,8000;JUMLAH_PENDUDUK "JUMLAH_PENDUDUK" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_PENDUDUK,-1,-1;JUMLAH_KK "JUMLAH_KK" true true false 4 Long 0 0,First,#,upload_file,JUMLAH_KK,-1,-1;LUAS_WILAYAH "LUAS_WILAYAH" true true false 8 Double 0 0,First,#,upload_file,LUAS_WILAYAH,-1,-1;KEPADATAN_PENDUDUK "KEPADATAN_PENDUDUK" true true false 8 Double 0 0,First,#,upload_file,KEPADATAN_PENDUDUK,-1,-1;PERPINDAHAN_PDDK "PERPINDAHAN_PDDK" true true false 4 Long 0 0,First,#,upload_file,PERPINDAHAN_PDDK,-1,-1;JML_MENINGGAL "JML_MENINGGAL" true true false 4 Long 0 0,First,#,upload_file,JML_MENINGGAL,-1,-1;PERUBAHAN_DATA "PERUBAHAN_DATA" true true false 4 Long 0 0,First,#,upload_file,PERUBAHAN_DATA,-1,-1;JML_WKTP "JML_WKTP" true true false 4 Long 0 0,First,#,upload_file,JML_WKTP,-1,-1;JML_REKAM_WKTP "JML_REKAM_WKTP" true true false 4 Long 0 0,First,#,upload_file,JML_REKAM_WKTP,-1,-1;FIELD1 "FIELD1" true true false 8000 Text 0 0,First,#,upload_file,FIELD1,0,8000;FIELD2 "FIELD2" true true false 8000 Text 0 0,First,#,upload_file,FIELD2,0,8000;ISLAM "ISLAM" true true false 4 Long 0 0,First,#,upload_file,ISLAM,-1,-1;KRISTEN "KRISTEN" true true false 4 Long 0 0,First,#,upload_file,KRISTEN,-1,-1;KATHOLIK "KATHOLIK" true true false 4 Long 0 0,First,#,upload_file,KATHOLIK,-1,-1;HINDU "HINDU" true true false 4 Long 0 0,First,#,upload_file,HINDU,-1,-1;BUDHA "BUDHA" true true false 4 Long 0 0,First,#,upload_file,BUDHA,-1,-1;KONGHUCU "KONGHUCU" true true false 4 Long 0 0,First,#,upload_file,KONGHUCU,-1,-1;KEPERCAYAAN "KEPERCAYAAN" true true false 4 Long 0 0,First,#,upload_file,KEPERCAYAAN,-1,-1;FIELD3 "FIELD3" true true false 8000 Text 0 0,First,#,upload_file,FIELD3,0,8000;FIELD4 "FIELD4" true true false 8000 Text 0 0,First,#,upload_file,FIELD4,0,8000;PRIA "PRIA" true true false 4 Long 0 0,First,#,upload_file,PRIA,-1,-1;WANITA "WANITA" true true false 4 Long 0 0,First,#,upload_file,WANITA,-1,-1;FIELD5 "FIELD5" true true false 8000 Text 0 0,First,#,upload_file,FIELD5,0,8000;FIELD6 "FIELD6" true true false 8000 Text 0 0,First,#,upload_file,FIELD6,0,8000;BELUM_KAWIN "BELUM_KAWIN" true true false 4 Long 0 0,First,#,upload_file,BELUM_KAWIN,-1,-1;KAWIN "KAWIN" true true false 4 Long 0 0,First,#,upload_file,KAWIN,-1,-1;CERAI_HIDUP "CERAI_HIDUP" true true false 4 Long 0 0,First,#,upload_file,CERAI_HIDUP,-1,-1;CERAI_MATI "CERAI_MATI" true true false 4 Long 0 0,First,#,upload_file,CERAI_MATI,-1,-1;FIELD7 "FIELD7" true true false 8000 Text 0 0,First,#,upload_file,FIELD7,0,8000;FIELD8 "FIELD8" true true false 8000 Text 0 0,First,#,upload_file,FIELD8,0,8000;U0 "U0" true true false 4 Long 0 0,First,#,upload_file,U0,-1,-1;U5 "U5" true true false 4 Long 0 0,First,#,upload_file,U5,-1,-1;U10 "U10" true true false 4 Long 0 0,First,#,upload_file,U10,-1,-1;U15 "U15" true true false 4 Long 0 0,First,#,upload_file,U15,-1,-1;U20 "U20" true true false 4 Long 0 0,First,#,upload_file,U20,-1,-1;U25 "U25" true true false 4 Long 0 0,First,#,upload_file,U25,-1,-1;U30 "U30" true true false 4 Long 0 0,First,#,upload_file,U30,-1,-1;U35 "U35" true true false 4 Long 0 0,First,#,upload_file,U35,-1,-1;U40 "U40" true true false 4 Long 0 0,First,#,upload_file,U40,-1,-1;U45 "U45" true true false 4 Long 0 0,First,#,upload_file,U45,-1,-1;U50 "U50" true true false 4 Long 0 0,First,#,upload_file,U50,-1,-1;U55 "U55" true true false 4 Long 0 0,First,#,upload_file,U55,-1,-1;U60 "U60" true true false 4 Long 0 0,First,#,upload_file,U60,-1,-1;U65 "U65" true true false 4 Long 0 0,First,#,upload_file,U65,-1,-1;U70 "U70" true true false 4 Long 0 0,First,#,upload_file,U70,-1,-1;U75 "U75" true true false 4 Long 0 0,First,#,upload_file,U75,-1,-1;FIELD9 "FIELD9" true true false 8000 Text 0 0,First,#,upload_file,FIELD9,0,8000;FIELD10 "FIELD10" true true false 8000 Text 0 0,First,#,upload_file,FIELD10,0,8000;LHR_2018 "LHR_2018" true true false 4 Long 0 0,First,#,upload_file,LHR_2018,-1,-1;LHR_SEBELUM_2018 "LHR_SEBELUM_2018" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2018,-1,-1;LHR_2019 "LHR_2019" true true false 4 Long 0 0,First,#,upload_file,LHR_2019,-1,-1;LHR_SEBELUM_2019 "LHR_SEBELUM_2019" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2019,-1,-1;LHR_2020 "LHR_2020" true true false 4 Long 0 0,First,#,upload_file,LHR_2020,-1,-1;LHR_SEBELUM_2020 "LHR_SEBELUM_2020" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2020,-1,-1;LHR_2021 "LHR_2021" true true false 4 Long 0 0,First,#,upload_file,LHR_2021,-1,-1;LHR_SEBELUM_2021 "LHR_SEBELUM_2021" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2021,-1,-1;LHR_2022 "LHR_2022" true true false 4 Long 0 0,First,#,upload_file,LHR_2022,-1,-1;LHR_SEBELUM_2022 "LHR_SEBELUM_2022" true true false 4 Long 0 0,First,#,upload_file,LHR_SEBELUM_2022,-1,-1;PERTUMBUHAN_2018 "PERTUMBUHAN_2018" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2018,-1,-1;PERTUMBUHAN_2019 "PERTUMBUHAN_2019" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2019,-1,-1;PERTUMBUHAN_2020 "PERTUMBUHAN_2020" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2020,-1,-1;PERTUMBUHAN_2021 "PERTUMBUHAN_2021" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2021,-1,-1;PERTUMBUHAN_2022 "PERTUMBUHAN_2022" true true false 4 Long 0 0,First,#,upload_file,PERTUMBUHAN_2022,-1,-1;FIELD11 "FIELD11" true true false 8000 Text 0 0,First,#,upload_file,FIELD11,0,8000;FIELD12 "FIELD12" true true false 8000 Text 0 0,First,#,upload_file,FIELD12,0,8000;USIA_SEKOLAH5_6 "USIA_SEKOLAH5_6" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH5_6,-1,-1;USIA_SEKOLAH7_12 "USIA_SEKOLAH7_12" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH7_12,-1,-1;USIA_SEKOLAH12_15 "USIA_SEKOLAH12_15" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH12_15,-1,-1;USIA_SEKOLAH16_18 "USIA_SEKOLAH16_18" true true false 4 Long 0 0,First,#,upload_file,USIA_SEKOLAH16_18,-1,-1;FIELD13 "FIELD13" true true false 8000 Text 0 0,First,#,upload_file,FIELD13,0,8000;FIELD14 "FIELD14" true true false 8000 Text 0 0,First,#,upload_file,FIELD14,0,8000;TIDAK_BLM_SEKOLAH "TIDAK_BLM_SEKOLAH" true true false 4 Long 0 0,First,#,upload_file,TIDAK_BLM_SEKOLAH,-1,-1;BELUM_TAMAT_SD "BELUM_TAMAT_SD" true true false 4 Long 0 0,First,#,upload_file,BELUM_TAMAT_SD,-1,-1;TAMAT_SD "TAMAT_SD" true true false 4 Long 0 0,First,#,upload_file,TAMAT_SD,-1,-1;SLTP "SLTP" true true false 4 Long 0 0,First,#,upload_file,SLTP,-1,-1;SLTA "SLTA" true true false 4 Long 0 0,First,#,upload_file,SLTA,-1,-1;D1_DAN_D2 "D1_DAN_D2" true true false 4 Long 0 0,First,#,upload_file,D1_DAN_D2,-1,-1;D3 "D3" true true false 4 Long 0 0,First,#,upload_file,D3,-1,-1;S1 "S1" true true false 4 Long 0 0,First,#,upload_file,S1,-1,-1;S2 "S2" true true false 4 Long 0 0,First,#,upload_file,S2,-1,-1;S3 "S3" true true false 4 Long 0 0,First,#,upload_file,S3,-1,-1;FIELD15 "FIELD15" true true false 8000 Text 0 0,First,#,upload_file,FIELD15,0,8000;FIELD16 "FIELD16" true true false 8000 Text 0 0,First,#,upload_file,FIELD16,0,8000;O "O" true true false 4 Long 0 0,First,#,upload_file,O,-1,-1;B- "B-" true true false 4 Long 0 0,First,#,upload_file,B-,-1,-1;B+ "B+" true true false 4 Long 0 0,First,#,upload_file,B+,-1,-1;O+ "O+" true true false 4 Long 0 0,First,#,upload_file,O+,-1,-1;AB- "AB-" true true false 4 Long 0 0,First,#,upload_file,AB-,-1,-1;A "A" true true false 4 Long 0 0,First,#,upload_file,A,-1,-1;TIDAK_TAHU "TIDAK_TAHU" true true false 4 Long 0 0,First,#,upload_file,TIDAK_TAHU,-1,-1;AB+ "AB+" true true false 4 Long 0 0,First,#,upload_file,AB+,-1,-1;A+ "A+" true true false 4 Long 0 0,First,#,upload_file,A+,-1,-1;A- "A-" true true false 4 Long 0 0,First,#,upload_file,A-,-1,-1;O- "O-" true true false 4 Long 0 0,First,#,upload_file,O-,-1,-1;B "B" true true false 4 Long 0 0,First,#,upload_file,B,-1,-1;AB "AB" true true false 4 Long 0 0,First,#,upload_file,AB,-1,-1;FIELD17 "FIELD17" true true false 8000 Text 0 0,First,#,upload_file,FIELD17,0,8000;FIELD18 "FIELD18" true true false 8000 Text 0 0,First,#,upload_file,FIELD18,0,8000;PENSIUNAN "PENSIUNAN" true true false 4 Long 0 0,First,#,upload_file,PENSIUNAN,-1,-1;MENGURUS_RUMAH_TANGGA "MENGURUS_RUMAH_TANGGA" true true false 4 Long 0 0,First,#,upload_file,MENGURUS_RUMAH_TANGGA,-1,-1;BELUM_TIDAK_BEKERJA "BELUM_TIDAK_BEKERJA" true true false 4 Long 0 0,First,#,upload_file,BELUM_TIDAK_BEKERJA,-1,-1;LAINNYA "LAINNYA" true true false 8000 Text 0 0,First,#,upload_file,LAINNYA,0,8000;PERDAGANGAN "PERDAGANGAN" true true false 4 Long 0 0,First,#,upload_file,PERDAGANGAN,-1,-1;PERAWAT "PERAWAT" true true false 4 Long 0 0,First,#,upload_file,PERAWAT,-1,-1;NELAYAN "NELAYAN" true true false 4 Long 0 0,First,#,upload_file,NELAYAN,-1,-1;PELAJAR_MAHASISWA "PELAJAR_MAHASISWA" true true false 4 Long 0 0,First,#,upload_file,PELAJAR_MAHASISWA,-1,-1;GURU "GURU" true true false 4 Long 0 0,First,#,upload_file,GURU,-1,-1;WIRASWASTA "WIRASWASTA" true true false 4 Long 0 0,First,#,upload_file,WIRASWASTA,-1,-1;PENGACARA "PENGACARA" true true false 4 Long 0 0,First,#,upload_file,PENGACARA,-1,-1;FIELD19 "FIELD19" true true false 8000 Text 0 0,First,#,upload_file,FIELD19,0,8000;FIELD20 "FIELD20" true true false 8000 Text 0 0,First,#,upload_file,FIELD20,0,8000', '')
			
			logProcess.logging_process_info('Success to convert {} table.'.format(table_name))
		
	def joinTable():
		upload_file = MyWatcher.run()
		file_name = upload_file.split(sep='\\')[-1]
		table_name = file_name.split(sep='.')[0]
		area_level = table_name.split(sep='_')[-2]
		
		logProcess.logging_process_info("Generate intermediate table...")
		
		if area_level == 'PROP':
			# Create Intermediate Table - PROPINSI
			data_fs_prop = os.path.join(output_gdb, 'giskemendagri.sde.Batas_Administrasi_BIG_2023\giskemendagri.sde.Batas_Provinsi_2023')
			int_table_prop = 'INT_AGR_VISUAL_PROP'
			
			arcpy.conversion.FeatureClassToFeatureClass(data_fs_prop, output_gdb, int_table_prop, '', 'no_prop "NO_PROP" true true false 4 Long 0 10,First,#,data_fs_prop,no_prop,-1,-1;nama_prop "NAMA_PROP" true true false 8000 Text 0 0,First,#,data_fs_prop,nama_prop,0,8000;st_area(shape) "st_area(shape)" false false true 0 Double 0 0,First,#,data_fs_prop,st_area(shape),-1,-1;st_length(shape) "st_length(shape)" false false true 0 Double 0 0,First,#,data_fs_prop,st_length(shape),-1,-1', '')
			
			logProcess.logging_process_info("Success to create intermediate table {}.".format(int_table_prop))

			# Join table to feature class
			logProcess.logging_process_info("Joining table to feature class...")

			input_prop = os.path.join(output_gdb, 'giskemendagri.sde.INT_AGR_VISUAL_PROP')
			join_prop = os.path.join(output_gdb, 'giskemendagri.sde.AGR_VISUAL_202202_PROP_FIX')
			arcpy.management.JoinField(input_prop, "no_prop", join_prop, "no_prop", None)

			logProcess.logging_process_info("Success to join table between {} & {}.".format(int_table_prop, table_name))

			# Create connection to database
			try:
				db_conn = psycopg2.connect(database="giskemendagri", user="sde", password="Gis12345", host="gisdb.dukcapil.kemendagri.go.id", port="5433")
				logProcess.logging_process_info("Success to connect database giskemendagri.")
			except Exception as e:
				logProcess.logging_process_error("Error to connect database")
				raise(e)

			# Truncate table
			try:
				cursor = db_conn.cursor()
				cursor.execute("DELETE FROM GISKEMENDAGRI.SDE.AGR_VISUAL_PROP_FIX")
				rows_deleted = cursor.rowcount
				db_conn.commit()
				cursor.close()
				logProcess.logging_process_info("Success to delete {} data.".format(rows_deleted))
				db_conn.close()
			except (Exception, psycopg2.DatabaseError) as e:
				raise(e)
		
			# Append data to feature service
			try:
				FS_AGR_PROP = os.path.join(output_gdb, 'giskemendagri.sde.AGR_VISUAL_PROP_FIX')
				arcpy.management.Append(input_prop, FS_AGR_PROP, "NO_TEST", r'no_prop "NO_PROP" true true false 4 Long 0 10,First,#,input_prop,no_prop,-1,-1;nama_prop "NAMA_PROP" true true false 8000 Text 0 0,First,#,input_prop,nama_prop,0,8000;jumlah_kabupaten "JUMLAH_KABUPATEN" true true false 4 Long 0 10,First,#,input_prop,jumlah_kabupaten,-1,-1;jumlah_kota "JUMLAH_KOTA" true true false 4 Long 0 10,First,#,input_prop,jumlah_kota,-1,-1;jumlah_kecamatan "JUMLAH_KECAMATAN" true true false 4 Long 0 10,First,#,input_prop,jumlah_kecamatan,-1,-1;jumlah_desa "JUMLAH_DESA" true true false 4 Long 0 10,First,#,input_prop,jumlah_desa,-1,-1;jumlah_kelurahan "JUMLAH_KELURAHAN" true true false 4 Long 0 10,First,#,input_prop,jumlah_kelurahan,-1,-1;jumlah_penduduk "JUMLAH_PENDUDUK" true true false 4 Long 0 10,First,#,input_prop,jumlah_penduduk,-1,-1;jumlah_kk "JUMLAH_KK" true true false 4 Long 0 10,First,#,input_prop,jumlah_kk,-1,-1;luas_wilayah "LUAS_WILAYAH" true true false 8 Double 8 38,First,#,input_prop,luas_wilayah,-1,-1;kepadatan_penduduk "KEPADATAN_PENDUDUK" true true false 4 Long 0 10,First,#,input_prop,kepadatan_penduduk,-1,-1;perpindahan_pddk "PERPINDAHAN_PDDK" true true false 4 Long 0 10,First,#,input_prop,perpindahan_pddk,-1,-1;jml_meninggal "JML_MENINGGAL" true true false 4 Long 0 10,First,#,input_prop,jml_meninggal,-1,-1;perubahan_data "PERUBAHAN_DATA" true true false 4 Long 0 10,First,#,input_prop,perubahan_data,-1,-1;jml_wktp "JML_WKTP" true true false 4 Long 0 10,First,#,input_prop,jml_wktp,-1,-1;jml_rekam_wktp "JML_REKAM_WKTP" true true false 4 Long 0 10,First,#,input_prop,jml_rekam_wktp,-1,-1;field1 "FIELD1" true true false 8000 Text 0 0,First,#,input_prop,field1,0,8000;field2 "FIELD2" true true false 8000 Text 0 0,First,#,input_prop,field2,0,8000;islam "ISLAM" true true false 4 Long 0 10,First,#,input_prop,islam,-1,-1;kristen "KRISTEN" true true false 4 Long 0 10,First,#,input_prop,kristen,-1,-1;katholik "KATHOLIK" true true false 4 Long 0 10,First,#,input_prop,katholik,-1,-1;hindu "HINDU" true true false 4 Long 0 10,First,#,input_prop,hindu,-1,-1;budha "BUDHA" true true false 4 Long 0 10,First,#,input_prop,budha,-1,-1;konghucu "KONGHUCU" true true false 4 Long 0 10,First,#,input_prop,konghucu,-1,-1;kepercayaan "KEPERCAYAAN" true true false 4 Long 0 10,First,#,input_prop,kepercayaan,-1,-1;field3 "FIELD3" true true false 8000 Text 0 0,First,#,input_prop,field3,0,8000;field4 "FIELD4" true true false 8000 Text 0 0,First,#,input_prop,field4,0,8000;pria "PRIA" true true false 4 Long 0 10,First,#,input_prop,pria,-1,-1;wanita "WANITA" true true false 4 Long 0 10,First,#,input_prop,wanita,-1,-1;field5 "FIELD5" true true false 8000 Text 0 0,First,#,input_prop,field5,0,8000;field6 "FIELD6" true true false 8000 Text 0 0,First,#,input_prop,field6,0,8000;belum_kawin "BELUM_KAWIN" true true false 4 Long 0 10,First,#,input_prop,belum_kawin,-1,-1;kawin "KAWIN" true true false 4 Long 0 10,First,#,input_prop,kawin,-1,-1;cerai_hidup "CERAI_HIDUP" true true false 4 Long 0 10,First,#,input_prop,cerai_hidup,-1,-1;cerai_mati "CERAI_MATI" true true false 4 Long 0 10,First,#,input_prop,cerai_mati,-1,-1;field7 "FIELD7" true true false 8000 Text 0 0,First,#,input_prop,field7,0,8000;field8 "FIELD8" true true false 8000 Text 0 0,First,#,input_prop,field8,0,8000;u0 "U0" true true false 4 Long 0 10,First,#,input_prop,u0,-1,-1;u5 "U5" true true false 4 Long 0 10,First,#,input_prop,u5,-1,-1;u10 "U10" true true false 4 Long 0 10,First,#,input_prop,u10,-1,-1;u15 "U15" true true false 4 Long 0 10,First,#,input_prop,u15,-1,-1;u20 "U20" true true false 4 Long 0 10,First,#,input_prop,u20,-1,-1;u25 "U25" true true false 4 Long 0 10,First,#,input_prop,u25,-1,-1;u30 "U30" true true false 4 Long 0 10,First,#,input_prop,u30,-1,-1;u35 "U35" true true false 4 Long 0 10,First,#,input_prop,u35,-1,-1;u40 "U40" true true false 4 Long 0 10,First,#,input_prop,u40,-1,-1;u45 "U45" true true false 4 Long 0 10,First,#,input_prop,u45,-1,-1;u50 "U50" true true false 4 Long 0 10,First,#,input_prop,u50,-1,-1;u55 "U55" true true false 4 Long 0 10,First,#,input_prop,u55,-1,-1;u60 "U60" true true false 4 Long 0 10,First,#,input_prop,u60,-1,-1;u65 "U65" true true false 4 Long 0 10,First,#,input_prop,u65,-1,-1;u70 "U70" true true false 4 Long 0 10,First,#,input_prop,u70,-1,-1;u75 "U75" true true false 4 Long 0 10,First,#,input_prop,u75,-1,-1;field9 "FIELD9" true true false 8000 Text 0 0,First,#,input_prop,field9,0,8000;field10 "FIELD10" true true false 8000 Text 0 0,First,#,input_prop,field10,0,8000;lhr_2018 "LHR_2018" true true false 4 Long 0 10,First,#,input_prop,lhr_2018,-1,-1;lhr_sebelum_2018 "LHR_SEBELUM_2018" true true false 4 Long 0 10,First,#,input_prop,lhr_sebelum_2018,-1,-1;lhr_2019 "LHR_2019" true true false 4 Long 0 10,First,#,input_prop,lhr_2019,-1,-1;lhr_sebelum_2019 "LHR_SEBELUM_2019" true true false 4 Long 0 10,First,#,input_prop,lhr_sebelum_2019,-1,-1;lhr_2020 "LHR_2020" true true false 4 Long 0 10,First,#,input_prop,lhr_2020,-1,-1;lhr_sebelum_2020 "LHR_SEBELUM_2020" true true false 4 Long 0 10,First,#,input_prop,lhr_sebelum_2020,-1,-1;lhr_2021 "LHR_2021" true true false 4 Long 0 10,First,#,input_prop,lhr_2021,-1,-1;lhr_sebelum_2021 "LHR_SEBELUM_2021" true true false 4 Long 0 10,First,#,input_prop,lhr_sebelum_2021,-1,-1;lhr_2022 "LHR_2022" true true false 4 Long 0 10,First,#,input_prop,lhr_2022,-1,-1;lhr_sebelum_2022 "LHR_SEBELUM_2022" true true false 4 Long 0 10,First,#,input_prop,lhr_sebelum_2022,-1,-1;pertumbuhan_2018 "PERTUMBUHAN_2018" true true false 4 Long 0 10,First,#,input_prop,pertumbuhan_2018,-1,-1;pertumbuhan_2019 "PERTUMBUHAN_2019" true true false 4 Long 0 10,First,#,input_prop,pertumbuhan_2019,-1,-1;pertumbuhan_2020 "PERTUMBUHAN_2020" true true false 4 Long 0 10,First,#,input_prop,pertumbuhan_2020,-1,-1;pertumbuhan_2021 "PERTUMBUHAN_2021" true true false 4 Long 0 10,First,#,input_prop,pertumbuhan_2021,-1,-1;pertumbuhan_2022 "PERTUMBUHAN_2022" true true false 4 Long 0 10,First,#,input_prop,pertumbuhan_2022,-1,-1;field11 "FIELD11" true true false 8000 Text 0 0,First,#,input_prop,field11,0,8000;field12 "FIELD12" true true false 8000 Text 0 0,First,#,input_prop,field12,0,8000;usia_sekolah5_6 "USIA_SEKOLAH5_6" true true false 4 Long 0 10,First,#,input_prop,usia_sekolah5_6,-1,-1;usia_sekolah7_12 "USIA_SEKOLAH7_12" true true false 4 Long 0 10,First,#,input_prop,usia_sekolah7_12,-1,-1;usia_sekolah12_15 "USIA_SEKOLAH12_15" true true false 4 Long 0 10,First,#,input_prop,usia_sekolah12_15,-1,-1;usia_sekolah16_18 "USIA_SEKOLAH16_18" true true false 4 Long 0 10,First,#,input_prop,usia_sekolah16_18,-1,-1;field13 "FIELD13" true true false 8000 Text 0 0,First,#,input_prop,field13,0,8000;field14 "FIELD14" true true false 8000 Text 0 0,First,#,input_prop,field14,0,8000;tidak_blm_sekolah "TIDAK_BLM_SEKOLAH" true true false 4 Long 0 10,First,#,input_prop,tidak_blm_sekolah,-1,-1;belum_tamat_sd "BELUM_TAMAT_SD" true true false 4 Long 0 10,First,#,input_prop,belum_tamat_sd,-1,-1;tamat_sd "TAMAT_SD" true true false 4 Long 0 10,First,#,input_prop,tamat_sd,-1,-1;sltp "SLTP" true true false 4 Long 0 10,First,#,input_prop,sltp,-1,-1;slta "SLTA" true true false 4 Long 0 10,First,#,input_prop,slta,-1,-1;d1_dan_d2 "D1_DAN_D2" true true false 4 Long 0 10,First,#,input_prop,d1_dan_d2,-1,-1;d3 "D3" true true false 4 Long 0 10,First,#,input_prop,d3,-1,-1;s1 "S1" true true false 4 Long 0 10,First,#,input_prop,s1,-1,-1;s2 "S2" true true false 4 Long 0 10,First,#,input_prop,s2,-1,-1;s3 "S3" true true false 4 Long 0 10,First,#,input_prop,s3,-1,-1;field15 "FIELD15" true true false 8000 Text 0 0,First,#,input_prop,field15,0,8000;field16 "FIELD16" true true false 8000 Text 0 0,First,#,input_prop,field16,0,8000;o "O" true true false 4 Long 0 10,First,#,input_prop,o,-1,-1;b_ "B-" true true false 4 Long 0 10,First,#,input_prop,b_,-1,-1;b1 "B+" true true false 4 Long 0 10,First,#,input_prop,b1,-1,-1;o_ "O+" true true false 4 Long 0 10,First,#,input_prop,o_,-1,-1;ab_ "AB-" true true false 4 Long 0 10,First,#,input_prop,ab_,-1,-1;a "A" true true false 4 Long 0 10,First,#,input_prop,a,-1,-1;tidak_tahu "TIDAK_TAHU" true true false 4 Long 0 10,First,#,input_prop,tidak_tahu,-1,-1;ab1 "AB+" true true false 4 Long 0 10,First,#,input_prop,ab1,-1,-1;a_ "A+" true true false 4 Long 0 10,First,#,input_prop,a_,-1,-1;a1 "A-" true true false 4 Long 0 10,First,#,input_prop,a1,-1,-1;o1 "O-" true true false 4 Long 0 10,First,#,input_prop,o1,-1,-1;b "B" true true false 4 Long 0 10,First,#,input_prop,b,-1,-1;ab "AB" true true false 4 Long 0 10,First,#,input_prop,ab,-1,-1;field17 "FIELD17" true true false 8000 Text 0 0,First,#,input_prop,field17,0,8000;field18 "FIELD18" true true false 8000 Text 0 0,First,#,input_prop,field18,0,8000;pensiunan "PENSIUNAN" true true false 4 Long 0 10,First,#,input_prop,pensiunan,-1,-1;mengurus_rumah_tangga "MENGURUS_RUMAH_TANGGA" true true false 4 Long 0 10,First,#,input_prop,mengurus_rumah_tangga,-1,-1;belum_tidak_bekerja "BELUM_TIDAK_BEKERJA" true true false 4 Long 0 10,First,#,input_prop,belum_tidak_bekerja,-1,-1;lainnya "LAINNYA" true true false 4 Long 0 10,First,#,input_prop,lainnya,-1,-1;perdagangan "PERDAGANGAN" true true false 4 Long 0 10,First,#,input_prop,perdagangan,-1,-1;perawat "PERAWAT" true true false 4 Long 0 10,First,#,input_prop,perawat,-1,-1;nelayan "NELAYAN" true true false 4 Long 0 10,First,#,input_prop,nelayan,-1,-1;pelajar_mahasiswa "PELAJAR_MAHASISWA" true true false 4 Long 0 10,First,#,input_prop,pelajar_mahasiswa,-1,-1;guru "GURU" true true false 4 Long 0 10,First,#,input_prop,guru,-1,-1;wiraswasta "WIRASWASTA" true true false 4 Long 0 10,First,#,input_prop,wiraswasta,-1,-1;pengacara "PENGACARA" true true false 4 Long 0 10,First,#,input_prop,pengacara,-1,-1;field19 "FIELD19" true true false 8000 Text 0 0,First,#,input_prop,field19,0,8000;field20 "FIELD20" true true false 8000 Text 0 0,First,#,input_prop,field20,0,8000', '', '')
				logProcess.logging_process_info("Success to append new data to feature service - PROVINSI.")
			except Exception as e:
				logProcess.logging_process_error("Error appending data.")
				raise(e)

		elif area_level == 'KAB':
			# Create Intermediate Table - KABUPATEN
			data_fs_kab = os.path.join(output_gdb, 'giskemendagri.sde.Batas_Administrasi_BIG_2023\giskemendagri.sde.Batas_Kabupaten_2023')
			int_table_kab = 'INT_AGR_VISUAL_KAB'
			
			arcpy.conversion.FeatureClassToFeatureClass(data_fs_kab, output_gdb, int_table_kab, '', 'no_prop "NO_PROP" true true false 4 Long 0 10,First,#,data_fs_kab,no_prop,-1,-1;no_kab "NO_KAB" true true false 4 Long 0 10,First,#,data_fs_kab,no_kab,-1,-1;kode_prop_spatial "KODE_PROP_SPATIAL" true true false 4 Long 0 10,First,#,data_fs_kab,kode_prop_spatial,-1,-1;kode_kab_spatial "KODE_KAB_SPATIAL" true true false 4 Long 0 10,First,#,data_fs_kab,kode_kab_spatial,-1,-1;jumlah_desa "JUMLAH_DESA" true true false 4 Long 0 10,First,#,data_fs_kab,jumlah_desa,-1,-1;jumlah_kelurahan "JUMLAH_KELURAHAN" true true false 4 Long 0 10,First,#,data_fs_kab,jumlah_kelurahan,-1,-1;nama_prop "NAMA_PROP" true true false 8000 Text 0 0,First,#,data_fs_kab,nama_prop,0,8000;nama_kab "NAMA_KAB" true true false 8000 Text 0 0,First,#,data_fs_kab,nama_kab,0,8000;st_area(shape) "st_area(shape)" false false true 0 Double 0 0,First,#,data_fs_kab,st_area(shape),-1,-1;st_length(shape) "st_length(shape)" false false true 0 Double 0 0,First,#,data_fs_kab,st_length(shape),-1,-1', '')
			
			logProcess.logging_process_info("Success to create intermediate table {}.".format(int_table_kab))

			# Join table to feature class
			logProcess.logging_process_info("Joining table to feature class...")

			input_kab = os.path.join(output_gdb, 'giskemendagri.sde.INT_AGR_VISUAL_KAB')
			join_kab = os.path.join(output_gdb, 'giskemendagri.sde.AGR_VISUAL_202202_KAB_FIX')
			arcpy.management.JoinField(input_kab, "kode_kab_spatial", join_kab, "kode_kab_spatial", None)

			logProcess.logging_process_info("Success to join table between {} & {}.".format(int_table_kab, table_name))

			# Create connection to database
			try:
				db_conn = psycopg2.connect(database="giskemendagri", user="sde", password="Gis12345", host="gisdb.dukcapil.kemendagri.go.id", port="5433")
				logProcess.logging_process_info("Success to connect database giskemendagri.")
			except Exception as e:
				logProcess.logging_process_error("Error to connect database")
				raise(e)

			# Truncate table
			try:
				cursor = db_conn.cursor()
				cursor.execute("DELETE FROM GISKEMENDAGRI.SDE.AGR_VISUAL_KAB_FIX")
				rows_deleted = cursor.rowcount
				db_conn.commit()
				cursor.close()
				logProcess.logging_process_info("Success to delete {} data.".format(rows_deleted))
				db_conn.close()
			except (Exception, psycopg2.DatabaseError) as e:
				raise(e)
			
			# Append data to feature service
			try:
				FS_AGR_KAB = os.path.join(output_gdb, 'giskemendagri.sde.AGR_VISUAL_KAB_FIX')
				arcpy.management.Append(input_kab, FS_AGR_KAB, "NO_TEST", r'no_prop "NO_PROP" true true false 4 Long 0 10,First,#,input_kab,no_prop_1,-1,-1;no_kab "NO_KAB" true true false 4 Long 0 10,First,#,input_kab,no_kab_1,-1,-1;kode_prop_spatial "KODE_PROP_SPATIAL" true true false 4 Long 0 10,First,#,input_kab,kode_prop_spatial_1,-1,-1;kode_kab_spatial "KODE_KAB_SPATIAL" true true false 4 Long 0 10,First,#,input_kab,kode_kab_spatial_1,-1,-1;jumlah_desa "JUMLAH_DESA" true true false 4 Long 0 10,First,#,input_kab,jumlah_desa_1,-1,-1;jumlah_kelurahan "JUMLAH_KELURAHAN" true true false 4 Long 0 10,First,#,input_kab,jumlah_kelurahan_1,-1,-1;nama_prop "NAMA_PROP" true true false 8000 Text 0 0,First,#,input_kab,nama_prop_1,0,8000;nama_kab "NAMA_KAB" true true false 8000 Text 0 0,First,#,input_kab,nama_kab_1,0,8000;jumlah_kecamatan "JUMLAH_KECAMATAN" true true false 4 Long 0 10,First,#,input_kab,jumlah_kecamatan,-1,-1;jumlah_penduduk "JUMLAH_PENDUDUK" true true false 4 Long 0 10,First,#,input_kab,jumlah_penduduk,-1,-1;jumlah_kk "JUMLAH_KK" true true false 4 Long 0 10,First,#,input_kab,jumlah_kk,-1,-1;luas_wilayah "LUAS_WILAYAH" true true false 8 Double 8 38,First,#,input_kab,luas_wilayah,-1,-1;kepadatan_penduduk "KEPADATAN_PENDUDUK" true true false 4 Long 0 10,First,#,input_kab,kepadatan_penduduk,-1,-1;perpindahan_pddk "PERPINDAHAN_PDDK" true true false 4 Long 0 10,First,#,input_kab,perpindahan_pddk,-1,-1;jml_meninggal "JML_MENINGGAL" true true false 4 Long 0 10,First,#,input_kab,jml_meninggal,-1,-1;perubahan_data "PERUBAHAN_DATA" true true false 4 Long 0 10,First,#,input_kab,perubahan_data,-1,-1;jml_wktp "JML_WKTP" true true false 4 Long 0 10,First,#,input_kab,jml_wktp,-1,-1;jml_rekam_wktp "JML_REKAM_WKTP" true true false 4 Long 0 10,First,#,input_kab,jml_rekam_wktp,-1,-1;field1 "FIELD1" true true false 8000 Text 0 0,First,#,input_kab,field1,0,8000;field2 "FIELD2" true true false 8000 Text 0 0,First,#,input_kab,field2,0,8000;islam "ISLAM" true true false 4 Long 0 10,First,#,input_kab,islam,-1,-1;kristen "KRISTEN" true true false 4 Long 0 10,First,#,input_kab,kristen,-1,-1;katholik "KATHOLIK" true true false 4 Long 0 10,First,#,input_kab,katholik,-1,-1;hindu "HINDU" true true false 4 Long 0 10,First,#,input_kab,hindu,-1,-1;budha "BUDHA" true true false 4 Long 0 10,First,#,input_kab,budha,-1,-1;konghucu "KONGHUCU" true true false 4 Long 0 10,First,#,input_kab,konghucu,-1,-1;kepercayaan "KEPERCAYAAN" true true false 4 Long 0 10,First,#,input_kab,kepercayaan,-1,-1;field3 "FIELD3" true true false 8000 Text 0 0,First,#,input_kab,field3,0,8000;field4 "FIELD4" true true false 8000 Text 0 0,First,#,input_kab,field4,0,8000;pria "PRIA" true true false 4 Long 0 10,First,#,input_kab,pria,-1,-1;wanita "WANITA" true true false 4 Long 0 10,First,#,input_kab,wanita,-1,-1;field5 "FIELD5" true true false 8000 Text 0 0,First,#,input_kab,field5,0,8000;field6 "FIELD6" true true false 8000 Text 0 0,First,#,input_kab,field6,0,8000;belum_kawin "BELUM_KAWIN" true true false 4 Long 0 10,First,#,input_kab,belum_kawin,-1,-1;kawin "KAWIN" true true false 4 Long 0 10,First,#,input_kab,kawin,-1,-1;cerai_hidup "CERAI_HIDUP" true true false 4 Long 0 10,First,#,input_kab,cerai_hidup,-1,-1;cerai_mati "CERAI_MATI" true true false 4 Long 0 10,First,#,input_kab,cerai_mati,-1,-1;field7 "FIELD7" true true false 8000 Text 0 0,First,#,input_kab,field7,0,8000;field8 "FIELD8" true true false 8000 Text 0 0,First,#,input_kab,field8,0,8000;u0 "U0" true true false 4 Long 0 10,First,#,input_kab,u0,-1,-1;u5 "U5" true true false 4 Long 0 10,First,#,input_kab,u5,-1,-1;u10 "U10" true true false 4 Long 0 10,First,#,input_kab,u10,-1,-1;u15 "U15" true true false 4 Long 0 10,First,#,input_kab,u15,-1,-1;u20 "U20" true true false 4 Long 0 10,First,#,input_kab,u20,-1,-1;u25 "U25" true true false 4 Long 0 10,First,#,input_kab,u25,-1,-1;u30 "U30" true true false 4 Long 0 10,First,#,input_kab,u30,-1,-1;u35 "U35" true true false 4 Long 0 10,First,#,input_kab,u35,-1,-1;u40 "U40" true true false 4 Long 0 10,First,#,input_kab,u40,-1,-1;u45 "U45" true true false 4 Long 0 10,First,#,input_kab,u45,-1,-1;u50 "U50" true true false 4 Long 0 10,First,#,input_kab,u50,-1,-1;u55 "U55" true true false 4 Long 0 10,First,#,input_kab,u55,-1,-1;u60 "U60" true true false 4 Long 0 10,First,#,input_kab,u60,-1,-1;u65 "U65" true true false 4 Long 0 10,First,#,input_kab,u65,-1,-1;u70 "U70" true true false 4 Long 0 10,First,#,input_kab,u70,-1,-1;u75 "U75" true true false 4 Long 0 10,First,#,input_kab,u75,-1,-1;field9 "FIELD9" true true false 8000 Text 0 0,First,#,input_kab,field9,0,8000;field10 "FIELD10" true true false 8000 Text 0 0,First,#,input_kab,field10,0,8000;lhr_2018 "LHR_2018" true true false 4 Long 0 10,First,#,input_kab,lhr_2018,-1,-1;lhr_sebelum_2018 "LHR_SEBELUM_2018" true true false 4 Long 0 10,First,#,input_kab,lhr_sebelum_2018,-1,-1;lhr_2019 "LHR_2019" true true false 4 Long 0 10,First,#,input_kab,lhr_2019,-1,-1;lhr_sebelum_2019 "LHR_SEBELUM_2019" true true false 4 Long 0 10,First,#,input_kab,lhr_sebelum_2019,-1,-1;lhr_2020 "LHR_2020" true true false 4 Long 0 10,First,#,input_kab,lhr_2020,-1,-1;lhr_sebelum_2020 "LHR_SEBELUM_2020" true true false 4 Long 0 10,First,#,input_kab,lhr_sebelum_2020,-1,-1;lhr_2021 "LHR_2021" true true false 4 Long 0 10,First,#,input_kab,lhr_2021,-1,-1;lhr_sebelum_2021 "LHR_SEBELUM_2021" true true false 4 Long 0 10,First,#,input_kab,lhr_sebelum_2021,-1,-1;lhr_2022 "LHR_2022" true true false 4 Long 0 10,First,#,input_kab,lhr_2022,-1,-1;lhr_sebelum_2022 "LHR_SEBELUM_2022" true true false 4 Long 0 10,First,#,input_kab,lhr_sebelum_2022,-1,-1;pertumbuhan_2018 "PERTUMBUHAN_2018" true true false 4 Long 0 10,First,#,input_kab,pertumbuhan_2018,-1,-1;pertumbuhan_2019 "PERTUMBUHAN_2019" true true false 4 Long 0 10,First,#,input_kab,pertumbuhan_2019,-1,-1;pertumbuhan_2020 "PERTUMBUHAN_2020" true true false 4 Long 0 10,First,#,input_kab,pertumbuhan_2020,-1,-1;pertumbuhan_2021 "PERTUMBUHAN_2021" true true false 4 Long 0 10,First,#,input_kab,pertumbuhan_2021,-1,-1;pertumbuhan_2022 "PERTUMBUHAN_2022" true true false 4 Long 0 10,First,#,input_kab,pertumbuhan_2022,-1,-1;field11 "FIELD11" true true false 8000 Text 0 0,First,#,input_kab,field11,0,8000;field12 "FIELD12" true true false 8000 Text 0 0,First,#,input_kab,field12,0,8000;usia_sekolah5_6 "USIA_SEKOLAH5_6" true true false 4 Long 0 10,First,#,input_kab,usia_sekolah5_6,-1,-1;usia_sekolah7_12 "USIA_SEKOLAH7_12" true true false 4 Long 0 10,First,#,input_kab,usia_sekolah7_12,-1,-1;usia_sekolah12_15 "USIA_SEKOLAH12_15" true true false 4 Long 0 10,First,#,input_kab,usia_sekolah12_15,-1,-1;usia_sekolah16_18 "USIA_SEKOLAH16_18" true true false 4 Long 0 10,First,#,input_kab,usia_sekolah16_18,-1,-1;field13 "FIELD13" true true false 8000 Text 0 0,First,#,input_kab,field13,0,8000;field14 "FIELD14" true true false 8000 Text 0 0,First,#,input_kab,field14,0,8000;tidak_blm_sekolah "TIDAK_BLM_SEKOLAH" true true false 4 Long 0 10,First,#,input_kab,tidak_blm_sekolah,-1,-1;belum_tamat_sd "BELUM_TAMAT_SD" true true false 4 Long 0 10,First,#,input_kab,belum_tamat_sd,-1,-1;tamat_sd "TAMAT_SD" true true false 4 Long 0 10,First,#,input_kab,tamat_sd,-1,-1;sltp "SLTP" true true false 4 Long 0 10,First,#,input_kab,sltp,-1,-1;slta "SLTA" true true false 4 Long 0 10,First,#,input_kab,slta,-1,-1;d1_dan_d2 "D1_DAN_D2" true true false 4 Long 0 10,First,#,input_kab,d1_dan_d2,-1,-1;d3 "D3" true true false 4 Long 0 10,First,#,input_kab,d3,-1,-1;s1 "S1" true true false 4 Long 0 10,First,#,input_kab,s1,-1,-1;s2 "S2" true true false 4 Long 0 10,First,#,input_kab,s2,-1,-1;s3 "S3" true true false 4 Long 0 10,First,#,input_kab,s3,-1,-1;field15 "FIELD15" true true false 8000 Text 0 0,First,#,input_kab,field15,0,8000;field16 "FIELD16" true true false 8000 Text 0 0,First,#,input_kab,field16,0,8000;o "O" true true false 4 Long 0 10,First,#,input_kab,o,-1,-1;b_ "B-" true true false 4 Long 0 10,First,#,input_kab,b_,-1,-1;b1 "B+" true true false 4 Long 0 10,First,#,input_kab,b1,-1,-1;o_ "O+" true true false 4 Long 0 10,First,#,input_kab,o_,-1,-1;ab_ "AB-" true true false 4 Long 0 10,First,#,input_kab,ab_,-1,-1;a "A" true true false 4 Long 0 10,First,#,input_kab,a,-1,-1;tidak_tahu "TIDAK_TAHU" true true false 4 Long 0 10,First,#,input_kab,tidak_tahu,-1,-1;ab1 "AB+" true true false 4 Long 0 10,First,#,input_kab,ab1,-1,-1;a_ "A+" true true false 4 Long 0 10,First,#,input_kab,a_,-1,-1;a1 "A-" true true false 4 Long 0 10,First,#,input_kab,a1,-1,-1;o1 "O-" true true false 4 Long 0 10,First,#,input_kab,o1,-1,-1;b "B" true true false 4 Long 0 10,First,#,input_kab,b,-1,-1;ab "AB" true true false 4 Long 0 10,First,#,input_kab,ab,-1,-1;field17 "FIELD17" true true false 8000 Text 0 0,First,#,input_kab,field17,0,8000;field18 "FIELD18" true true false 8000 Text 0 0,First,#,input_kab,field18,0,8000;pensiunan "PENSIUNAN" true true false 4 Long 0 10,First,#,input_kab,pensiunan,-1,-1;mengurus_rumah_tangga "MENGURUS_RUMAH_TANGGA" true true false 4 Long 0 10,First,#,input_kab,mengurus_rumah_tangga,-1,-1;belum_tidak_bekerja "BELUM_TIDAK_BEKERJA" true true false 4 Long 0 10,First,#,input_kab,belum_tidak_bekerja,-1,-1;lainnya "LAINNYA" true true false 4 Long 0 10,First,#,input_kab,lainnya,-1,-1;perdagangan "PERDAGANGAN" true true false 4 Long 0 10,First,#,input_kab,perdagangan,-1,-1;perawat "PERAWAT" true true false 4 Long 0 10,First,#,input_kab,perawat,-1,-1;nelayan "NELAYAN" true true false 4 Long 0 10,First,#,input_kab,nelayan,-1,-1;pelajar_mahasiswa "PELAJAR_MAHASISWA" true true false 4 Long 0 10,First,#,input_kab,pelajar_mahasiswa,-1,-1;guru "GURU" true true false 4 Long 0 10,First,#,input_kab,guru,-1,-1;wiraswasta "WIRASWASTA" true true false 4 Long 0 10,First,#,input_kab,wiraswasta,-1,-1;pengacara "PENGACARA" true true false 4 Long 0 10,First,#,input_kab,pengacara,-1,-1;field19 "FIELD19" true true false 8000 Text 0 0,First,#,input_kab,field19,0,8000;field20 "FIELD20" true true false 8000 Text 0 0,First,#,input_kab,field20,0,8000', '', '')
				logProcess.logging_process_info("Success to append new data to feature service - KABUPATEN.")
			except Exception as e:
				logProcess.logging_process_error("Error appending data.")
				raise(e)
			
		elif area_level == 'KEC':
			# Create Intermediate Table - KECAMATAN
			data_fs_kec = os.path.join(output_gdb, 'giskemendagri.sde.Batas_Administrasi_BIG_2023\giskemendagri.sde.Batas_Kecamatan_2023')
			int_table_kec = 'INT_AGR_VISUAL_KEC'

			arcpy.conversion.FeatureClassToFeatureClass(data_fs_kec, output_gdb, int_table_kec, '', 'objectid "OBJECTID" true true false 4 Long 0 10,First,#,data_fs_kec,objectid,-1,-1;no_prop "NO_PROP" true true false 4 Long 0 10,First,#,data_fs_kec,no_prop,-1,-1;no_kab "NO_KAB" true true false 4 Long 0 10,First,#,data_fs_kec,no_kab,-1,-1;no_kec "NO_KEC" true true false 4 Long 0 10,First,#,data_fs_kec,no_kec,-1,-1;kode_prop_spatial "KODE_PROP_SPATIAL" true true false 4 Long 0 10,First,#,data_fs_kec,kode_prop_spatial,-1,-1;kode_kab_spatial "KODE_KAB_SPATIAL" true true false 4 Long 0 10,First,#,data_fs_kec,kode_kab_spatial,-1,-1;kode_kec_spatial "KODE_KEC_SPATIAL" true true false 4 Long 0 10,First,#,data_fs_kec,kode_kec_spatial,-1,-1;nama_prop "NAMA_PROP" true true false 8000 Text 0 0,First,#,data_fs_kec,nama_prop,0,8000;nama_kab "NAMA_KAB" true true false 8000 Text 0 0,First,#,data_fs_kec,nama_kab,0,8000;nama_kec "NAMA_KEC" true true false 8000 Text 0 0,First,#,data_fs_kec,nama_kec,0,8000;st_area(shape) "st_area(shape)" false false true 0 Double 0 0,First,#,data_fs_kec,st_area(shape),-1,-1;st_length(shape) "st_length(shape)" false false true 0 Double 0 0,First,#,data_fs_kec,st_length(shape),-1,-1', '')

			logProcess.logging_process_info("Success to create intermediate table {}.".format(int_table_kec))

			# Join table to feature class
			logProcess.logging_process_info("Joining table to feature class...")

			input_kec = os.path.join(output_gdb, 'giskemendagri.sde.INT_AGR_VISUAL_KEC')
			join_kec = os.path.join(output_gdb, 'giskemendagri.sde.AGR_VISUAL_202202_KEC_FIX')
			arcpy.management.JoinField(input_kec, "kode_kec_spatial", join_kec, "kode_kec_spatial", None)

			logProcess.logging_process_info("Success to join table between {} & {}.".format(int_table_kec, table_name))

			# Create connection to database
			try:
				db_conn = psycopg2.connect(database="giskemendagri", user="sde", password="Gis12345", host="gisdb.dukcapil.kemendagri.go.id", port="5433")
				logProcess.logging_process_info("Success to connect database giskemendagri.")
			except Exception as e:
				logProcess.logging_process_error("Error to connect database")
				raise(e)

			# Truncate table
			try:
				cursor = db_conn.cursor()
				cursor.execute("DELETE FROM GISKEMENDAGRI.SDE.AGR_VISUAL_KEC_FIX")
				rows_deleted = cursor.rowcount
				db_conn.commit()
				cursor.close()
				logProcess.logging_process_info("Success to delete {} data.".format(rows_deleted))
				db_conn.close()
			except (Exception, psycopg2.DatabaseError) as e:
				raise(e)
			
			# Append data to feature service
			try:
				FS_AGR_KEC = os.path.join(output_gdb, 'giskemendagri.sde.AGR_VISUAL_KEC_FIX')
				arcpy.management.Append(input_kec, FS_AGR_KEC, "NO_TEST", r'no_prop "NO_PROP" true true false 4 Long 0 10,First,#,input_kec,no_prop_1,-1,-1;no_kab "NO_KAB" true true false 4 Long 0 10,First,#,input_kec,no_kab_1,-1,-1;no_kec "NO_KEC" true true false 4 Long 0 10,First,#,input_kec,no_kec_1,-1,-1;kode_prop_spatial "KODE_PROP_SPATIAL" true true false 4 Long 0 10,First,#,input_kec,kode_prop_spatial_1,-1,-1;kode_kab_spatial "KODE_KAB_SPATIAL" true true false 4 Long 0 10,First,#,input_kec,kode_kab_spatial_1,-1,-1;kode_kec_spatial "KODE_KEC_SPATIAL" true true false 4 Long 0 10,First,#,input_kec,kode_kec_spatial_1,-1,-1;nama_prop "NAMA_PROP" true true false 8000 Text 0 0,First,#,input_kec,nama_prop_1,0,8000;nama_kab "NAMA_KAB" true true false 8000 Text 0 0,First,#,input_kec,nama_kab_1,0,8000;nama_kec "NAMA_KEC" true true false 8000 Text 0 0,First,#,input_kec,nama_kec_1,0,8000;jumlah_desa "JUMLAH_DESA" true true false 4 Long 0 10,First,#,input_kec,jumlah_desa,-1,-1;jumlah_kelurahan "JUMLAH_KELURAHAN" true true false 4 Long 0 10,First,#,input_kec,jumlah_kelurahan,-1,-1;jumlah_penduduk "JUMLAH_PENDUDUK" true true false 4 Long 0 10,First,#,input_kec,jumlah_penduduk,-1,-1;jumlah_kk "JUMLAH_KK" true true false 4 Long 0 10,First,#,input_kec,jumlah_kk,-1,-1;luas_wilayah "LUAS_WILAYAH" true true false 8 Double 8 38,First,#,input_kec,luas_wilayah,-1,-1;kepadatan_penduduk "KEPADATAN_PENDUDUK" true true false 8 Double 8 38,First,#,input_kec,kepadatan_penduduk,-1,-1;perpindahan_pddk "PERPINDAHAN_PDDK" true true false 4 Long 0 10,First,#,input_kec,perpindahan_pddk,-1,-1;jml_meninggal "JML_MENINGGAL" true true false 4 Long 0 10,First,#,input_kec,jml_meninggal,-1,-1;perubahan_data "PERUBAHAN_DATA" true true false 4 Long 0 10,First,#,input_kec,perubahan_data,-1,-1;jml_wktp "JML_WKTP" true true false 4 Long 0 10,First,#,input_kec,jml_wktp,-1,-1;jml_rekam_wktp "JML_REKAM_WKTP" true true false 4 Long 0 10,First,#,input_kec,jml_rekam_wktp,-1,-1;field1 "FIELD1" true true false 8000 Text 0 0,First,#,input_kec,field1,0,8000;field2 "FIELD2" true true false 8000 Text 0 0,First,#,input_kec,field2,0,8000;islam "ISLAM" true true false 4 Long 0 10,First,#,input_kec,islam,-1,-1;kristen "KRISTEN" true true false 4 Long 0 10,First,#,input_kec,kristen,-1,-1;katholik "KATHOLIK" true true false 4 Long 0 10,First,#,input_kec,katholik,-1,-1;hindu "HINDU" true true false 4 Long 0 10,First,#,input_kec,hindu,-1,-1;budha "BUDHA" true true false 4 Long 0 10,First,#,input_kec,budha,-1,-1;konghucu "KONGHUCU" true true false 4 Long 0 10,First,#,input_kec,konghucu,-1,-1;kepercayaan "KEPERCAYAAN" true true false 4 Long 0 10,First,#,input_kec,kepercayaan,-1,-1;field3 "FIELD3" true true false 8000 Text 0 0,First,#,input_kec,field3,0,8000;field4 "FIELD4" true true false 8000 Text 0 0,First,#,input_kec,field4,0,8000;pria "PRIA" true true false 4 Long 0 10,First,#,input_kec,pria,-1,-1;wanita "WANITA" true true false 4 Long 0 10,First,#,input_kec,wanita,-1,-1;field5 "FIELD5" true true false 8000 Text 0 0,First,#,input_kec,field5,0,8000;field6 "FIELD6" true true false 8000 Text 0 0,First,#,input_kec,field6,0,8000;kawin "KAWIN" true true false 4 Long 0 10,First,#,input_kec,kawin,-1,-1;belum_kawin "BELUM_KAWIN" true true false 4 Long 0 10,First,#,input_kec,belum_kawin,-1,-1;cerai_hidup "CERAI_HIDUP" true true false 4 Long 0 10,First,#,input_kec,cerai_hidup,-1,-1;cerai_mati "CERAI_MATI" true true false 4 Long 0 10,First,#,input_kec,cerai_mati,-1,-1;field7 "FIELD7" true true false 8000 Text 0 0,First,#,input_kec,field7,0,8000;field8 "FIELD8" true true false 8000 Text 0 0,First,#,input_kec,field8,0,8000;u0 "U0" true true false 4 Long 0 10,First,#,input_kec,u0,-1,-1;u5 "U5" true true false 4 Long 0 10,First,#,input_kec,u5,-1,-1;u10 "U10" true true false 4 Long 0 10,First,#,input_kec,u10,-1,-1;u15 "U15" true true false 4 Long 0 10,First,#,input_kec,u15,-1,-1;u20 "U20" true true false 4 Long 0 10,First,#,input_kec,u20,-1,-1;u25 "U25" true true false 4 Long 0 10,First,#,input_kec,u25,-1,-1;u30 "U30" true true false 4 Long 0 10,First,#,input_kec,u30,-1,-1;u35 "U35" true true false 4 Long 0 10,First,#,input_kec,u35,-1,-1;u40 "U40" true true false 4 Long 0 10,First,#,input_kec,u40,-1,-1;u45 "U45" true true false 4 Long 0 10,First,#,input_kec,u45,-1,-1;u50 "U50" true true false 4 Long 0 10,First,#,input_kec,u50,-1,-1;u55 "U55" true true false 4 Long 0 10,First,#,input_kec,u55,-1,-1;u60 "U60" true true false 4 Long 0 10,First,#,input_kec,u60,-1,-1;u65 "U65" true true false 4 Long 0 10,First,#,input_kec,u65,-1,-1;u70 "U70" true true false 4 Long 0 10,First,#,input_kec,u70,-1,-1;u75 "U75" true true false 4 Long 0 10,First,#,input_kec,u75,-1,-1;field9 "FIELD9" true true false 8000 Text 0 0,First,#,input_kec,field9,0,8000;field10 "FIELD10" true true false 8000 Text 0 0,First,#,input_kec,field10,0,8000;lhr_2018 "LHR_2018" true true false 4 Long 0 10,First,#,input_kec,lhr_2018,-1,-1;lhr_sebelum_2018 "LHR_SEBELUM_2018" true true false 4 Long 0 10,First,#,input_kec,lhr_sebelum_2018,-1,-1;lhr_2019 "LHR_2019" true true false 4 Long 0 10,First,#,input_kec,lhr_2019,-1,-1;lhr_sebelum_2019 "LHR_SEBELUM_2019" true true false 4 Long 0 10,First,#,input_kec,lhr_sebelum_2019,-1,-1;lhr_2020 "LHR_2020" true true false 4 Long 0 10,First,#,input_kec,lhr_2020,-1,-1;lhr_sebelum_2020 "LHR_SEBELUM_2020" true true false 4 Long 0 10,First,#,input_kec,lhr_sebelum_2020,-1,-1;lhr_2021 "LHR_2021" true true false 4 Long 0 10,First,#,input_kec,lhr_2021,-1,-1;lhr_sebelum_2021 "LHR_SEBELUM_2021" true true false 4 Long 0 10,First,#,input_kec,lhr_sebelum_2021,-1,-1;lhr_2022 "LHR_2022" true true false 4 Long 0 10,First,#,input_kec,lhr_2022,-1,-1;lhr_sebelum_2022 "LHR_SEBELUM_2022" true true false 4 Long 0 10,First,#,input_kec,lhr_sebelum_2022,-1,-1;pertumbuhan_2018 "PERTUMBUHAN_2018" true true false 4 Long 0 10,First,#,input_kec,pertumbuhan_2018,-1,-1;pertumbuhan_2019 "PERTUMBUHAN_2019" true true false 4 Long 0 10,First,#,input_kec,pertumbuhan_2019,-1,-1;pertumbuhan_2020 "PERTUMBUHAN_2020" true true false 4 Long 0 10,First,#,input_kec,pertumbuhan_2020,-1,-1;pertumbuhan_2021 "PERTUMBUHAN_2021" true true false 4 Long 0 10,First,#,input_kec,pertumbuhan_2021,-1,-1;pertumbuhan_2022 "PERTUMBUHAN_2022" true true false 4 Long 0 10,First,#,input_kec,pertumbuhan_2022,-1,-1;field11 "FIELD11" true true false 8000 Text 0 0,First,#,input_kec,field11,0,8000;field12 "FIELD12" true true false 8000 Text 0 0,First,#,input_kec,field12,0,8000;usia_sekolah5_6 "USIA_SEKOLAH5_6" true true false 4 Long 0 10,First,#,input_kec,usia_sekolah5_6,-1,-1;usia_sekolah7_12 "USIA_SEKOLAH7_12" true true false 4 Long 0 10,First,#,input_kec,usia_sekolah7_12,-1,-1;usia_sekolah12_15 "USIA_SEKOLAH12_15" true true false 4 Long 0 10,First,#,input_kec,usia_sekolah12_15,-1,-1;usia_sekolah16_18 "USIA_SEKOLAH16_18" true true false 4 Long 0 10,First,#,input_kec,usia_sekolah16_18,-1,-1;field13 "FIELD13" true true false 8000 Text 0 0,First,#,input_kec,field13,0,8000;field14 "FIELD14" true true false 8000 Text 0 0,First,#,input_kec,field14,0,8000;tidak_blm_sekolah "TIDAK_BLM_SEKOLAH" true true false 4 Long 0 10,First,#,input_kec,tidak_blm_sekolah,-1,-1;belum_tamat_sd "BELUM_TAMAT_SD" true true false 4 Long 0 10,First,#,input_kec,belum_tamat_sd,-1,-1;tamat_sd "TAMAT_SD" true true false 4 Long 0 10,First,#,input_kec,tamat_sd,-1,-1;sltp "SLTP" true true false 4 Long 0 10,First,#,input_kec,sltp,-1,-1;slta "SLTA" true true false 4 Long 0 10,First,#,input_kec,slta,-1,-1;d1_dan_d2 "D1_DAN_D2" true true false 4 Long 0 10,First,#,input_kec,d1_dan_d2,-1,-1;d3 "D3" true true false 4 Long 0 10,First,#,input_kec,d3,-1,-1;s1 "S1" true true false 4 Long 0 10,First,#,input_kec,s1,-1,-1;s2 "S2" true true false 4 Long 0 10,First,#,input_kec,s2,-1,-1;s3 "S3" true true false 4 Long 0 10,First,#,input_kec,s3,-1,-1;field15 "FIELD15" true true false 8000 Text 0 0,First,#,input_kec,field15,0,8000;field16 "FIELD16" true true false 8000 Text 0 0,First,#,input_kec,field16,0,8000;o "O" true true false 4 Long 0 10,First,#,input_kec,o,-1,-1;b_ "B-" true true false 4 Long 0 10,First,#,input_kec,b_,-1,-1;b1 "B+" true true false 4 Long 0 10,First,#,input_kec,b1,-1,-1;o_ "O+" true true false 4 Long 0 10,First,#,input_kec,o_,-1,-1;ab_ "AB-" true true false 4 Long 0 10,First,#,input_kec,ab_,-1,-1;a "A" true true false 4 Long 0 10,First,#,input_kec,a,-1,-1;tidak_tahu "TIDAK_TAHU" true true false 4 Long 0 10,First,#,input_kec,tidak_tahu,-1,-1;ab1 "AB+" true true false 4 Long 0 10,First,#,input_kec,ab1,-1,-1;a_ "A+" true true false 4 Long 0 10,First,#,input_kec,a_,-1,-1;a1 "A-" true true false 4 Long 0 10,First,#,input_kec,a1,-1,-1;o1 "O-" true true false 4 Long 0 10,First,#,input_kec,o1,-1,-1;b "B" true true false 4 Long 0 10,First,#,input_kec,b,-1,-1;ab "AB" true true false 4 Long 0 10,First,#,input_kec,ab,-1,-1;field17 "FIELD17" true true false 8000 Text 0 0,First,#,input_kec,field17,0,8000;field18 "FIELD18" true true false 8000 Text 0 0,First,#,input_kec,field18,0,8000;pensiunan "PENSIUNAN" true true false 4 Long 0 10,First,#,input_kec,pensiunan,-1,-1;mengurus_rumah_tangga "MENGURUS_RUMAH_TANGGA" true true false 4 Long 0 10,First,#,input_kec,mengurus_rumah_tangga,-1,-1;belum_tidak_bekerja "BELUM_TIDAK_BEKERJA" true true false 4 Long 0 10,First,#,input_kec,belum_tidak_bekerja,-1,-1;lainnya "LAINNYA" true true false 4 Long 0 10,First,#,input_kec,lainnya,-1,-1;perdagangan "PERDAGANGAN" true true false 4 Long 0 10,First,#,input_kec,perdagangan,-1,-1;perawat "PERAWAT" true true false 4 Long 0 10,First,#,input_kec,perawat,-1,-1;nelayan "NELAYAN" true true false 4 Long 0 10,First,#,input_kec,nelayan,-1,-1;pelajar_mahasiswa "PELAJAR_MAHASISWA" true true false 4 Long 0 10,First,#,input_kec,pelajar_mahasiswa,-1,-1;guru "GURU" true true false 4 Long 0 10,First,#,input_kec,guru,-1,-1;wiraswasta "WIRASWASTA" true true false 4 Long 0 10,First,#,input_kec,wiraswasta,-1,-1;pengacara "PENGACARA" true true false 4 Long 0 10,First,#,input_kec,pengacara,-1,-1;field19 "FIELD19" true true false 8000 Text 0 0,First,#,input_kec,field19,0,8000;field20 "FIELD20" true true false 8000 Text 0 0,First,#,input_kec,field20,0,8000', '', '')
				logProcess.logging_process_info("Success to append new data to feature service - KECAMATAN.")
			except Exception as e:
				logProcess.logging_process_error("Error appending data.")
				raise(e)
			
		else:
			# Create Intermediate Table - KELURAHAN
			data_fs_kel = os.path.join(output_gdb, 'giskemendagri.sde.Batas_Administrasi_BIG_2023\giskemendagri.sde.Batas_Kelurahan_2023')
			int_table_kel = 'INT_AGR_VISUAL_KEL'

			arcpy.conversion.FeatureClassToFeatureClass(data_fs_kel, output_gdb, int_table_kel, '', 'no_prop "NO_PROP" true true false 4 Long 0 10,First,#,data_fs_kel,no_prop,-1,-1;no_kab "NO_KAB" true true false 4 Long 0 10,First,#,data_fs_kel,no_kab,-1,-1;no_kec "NO_KEC" true true false 4 Long 0 10,First,#,data_fs_kel,no_kec,-1,-1;no_kel "NO_KEL" true true false 4 Long 0 10,First,#,data_fs_kel,no_kel,-1,-1;kode_desa_spatial "KODE_DESA_SPATIAL" true true false 8 Double 8 38,First,#,data_fs_kel,kode_desa_spatial,-1,-1;nama_prop "NAMA_PROP" true true false 8000 Text 0 0,First,#,data_fs_kel,nama_prop,0,8000;nama_kab "NAMA_KAB" true true false 8000 Text 0 0,First,#,data_fs_kel,nama_kab,0,8000;nama_kec "NAMA_KEC" true true false 8000 Text 0 0,First,#,data_fs_kel,nama_kec,0,8000;nama_kel "NAMA_KEL" true true false 8000 Text 0 0,First,#,data_fs_kel,nama_kel,0,8000;st_area(shape) "st_area(shape)" false false true 0 Double 0 0,First,#,data_fs_kel,st_area(shape),-1,-1;st_length(shape) "st_length(shape)" false false true 0 Double 0 0,First,#,data_fs_kel,st_length(shape),-1,-1', '')

			logProcess.logging_process_info("Success to create intermediate table {}.".format(int_table_kel))

			# Join table to feature class
			logProcess.logging_process_info("Joining table to feature class...")

			input_kel = os.path.join(output_gdb, 'giskemendagri.sde.INT_AGR_VISUAL_KEL')
			join_kel = os.path.join(output_gdb, 'giskemendagri.sde.AGR_VISUAL_202202_KEL_FIX')
			arcpy.management.JoinField(input_kel, "kode_desa_spatial", join_kel, "kode_desa_spatial", None)

			logProcess.logging_process_info("Success to join table between {} & {}.".format(int_table_kel, table_name))

			# Create connection to database
			try:
				db_conn = psycopg2.connect(database="giskemendagri", user="sde", password="Gis12345", host="gisdb.dukcapil.kemendagri.go.id", port="5433")
				logProcess.logging_process_info("Success to connect database giskemendagri.")
			except Exception as e:
				logProcess.logging_process_error("Error to connect database")
				raise(e)

			# Truncate table
			try:
				cursor = db_conn.cursor()
				cursor.execute("DELETE FROM GISKEMENDAGRI.SDE.AGR_VISUAL_KEL_FIX")
				rows_deleted = cursor.rowcount
				db_conn.commit()
				cursor.close()
				logProcess.logging_process_info("Success to delete {} data.".format(rows_deleted))
				db_conn.close()
			except (Exception, psycopg2.DatabaseError) as e:
				raise(e)

			# Append data to feature service
			try:
				FS_AGR_KEL = os.path.join(output_gdb, 'giskemendagri.sde.AGR_VISUAL_KEL_FIX')
				arcpy.management.Append(input_kel, FS_AGR_KEL, "NO_TEST", r'no_prop "NO_PROP" true true false 4 Long 0 10,First,#,input_kel,no_prop,-1,-1;no_kab "NO_KAB" true true false 4 Long 0 10,First,#,input_kel,no_kab,-1,-1;no_kec "NO_KEC" true true false 4 Long 0 10,First,#,input_kel,no_kec,-1,-1;no_kel "NO_KEL" true true false 4 Long 0 10,First,#,input_kel,no_kel,-1,-1;kode_desa_spatial "KODE_DESA_SPATIAL" true true false 8 Double 8 38,First,#,input_kel,kode_desa_spatial,-1,-1;nama_prop "NAMA_PROP" true true false 8000 Text 0 0,First,#,input_kel,nama_prop,0,8000;nama_kab "NAMA_KAB" true true false 8000 Text 0 0,First,#,input_kel,nama_kab,0,8000;nama_kec "NAMA_KEC" true true false 8000 Text 0 0,First,#,input_kel,nama_kec,0,8000;nama_kel "NAMA_KEL" true true false 8000 Text 0 0,First,#,input_kel,nama_kel,0,8000;jumlah_penduduk "JUMLAH_PENDUDUK" true true false 4 Long 0 10,First,#,input_kel,jumlah_penduduk,-1,-1;jumlah_kk "JUMLAH_KK" true true false 4 Long 0 10,First,#,input_kel,jumlah_kk,-1,-1;luas_wilayah "LUAS_WILAYAH" true true false 8 Double 8 38,First,#,input_kel,luas_wilayah,-1,-1;kepadatan_penduduk "KEPADATAN_PENDUDUK" true true false 8 Double 8 38,First,#,input_kel,kepadatan_penduduk,-1,-1;perpindahan_pddk "PERPINDAHAN_PDDK" true true false 4 Long 0 10,First,#,input_kel,perpindahan_pddk,-1,-1;jml_meninggal "JML_MENINGGAL" true true false 4 Long 0 10,First,#,input_kel,jml_meninggal,-1,-1;perubahan_data "PERUBAHAN_DATA" true true false 4 Long 0 10,First,#,input_kel,perubahan_data,-1,-1;jml_wktp "JML_WKTP" true true false 4 Long 0 10,First,#,input_kel,jml_wktp,-1,-1;jml_rekam_wktp "JML_REKAM_WKTP" true true false 4 Long 0 10,First,#,input_kel,jml_rekam_wktp,-1,-1;field1 "FIELD1" true true false 8000 Text 0 0,First,#,input_kel,field1,0,8000;field2 "FIELD2" true true false 8000 Text 0 0,First,#,input_kel,field2,0,8000;islam "ISLAM" true true false 4 Long 0 10,First,#,input_kel,islam,-1,-1;kristen "KRISTEN" true true false 4 Long 0 10,First,#,input_kel,kristen,-1,-1;katholik "KATHOLIK" true true false 4 Long 0 10,First,#,input_kel,katholik,-1,-1;hindu "HINDU" true true false 4 Long 0 10,First,#,input_kel,hindu,-1,-1;budha "BUDHA" true true false 4 Long 0 10,First,#,input_kel,budha,-1,-1;konghucu "KONGHUCU" true true false 4 Long 0 10,First,#,input_kel,konghucu,-1,-1;kepercayaan "KEPERCAYAAN" true true false 4 Long 0 10,First,#,input_kel,kepercayaan,-1,-1;field3 "FIELD3" true true false 8000 Text 0 0,First,#,input_kel,field3,0,8000;field4 "FIELD4" true true false 8000 Text 0 0,First,#,input_kel,field4,0,8000;pria "PRIA" true true false 4 Long 0 10,First,#,input_kel,pria,-1,-1;wanita "WANITA" true true false 4 Long 0 10,First,#,input_kel,wanita,-1,-1;field5 "FIELD5" true true false 8000 Text 0 0,First,#,input_kel,field5,0,8000;field6 "FIELD6" true true false 8000 Text 0 0,First,#,input_kel,field6,0,8000;belum_kawin "BELUM_KAWIN" true true false 4 Long 0 10,First,#,input_kel,belum_kawin,-1,-1;kawin "KAWIN" true true false 4 Long 0 10,First,#,input_kel,kawin,-1,-1;cerai_hidup "CERAI_HIDUP" true true false 4 Long 0 10,First,#,input_kel,cerai_hidup,-1,-1;cerai_mati "CERAI_MATI" true true false 4 Long 0 10,First,#,input_kel,cerai_mati,-1,-1;field7 "FIELD7" true true false 8000 Text 0 0,First,#,input_kel,field7,0,8000;field8 "FIELD8" true true false 8000 Text 0 0,First,#,input_kel,field8,0,8000;u0 "U0" true true false 4 Long 0 10,First,#,input_kel,u0,-1,-1;u5 "U5" true true false 4 Long 0 10,First,#,input_kel,u5,-1,-1;u10 "U10" true true false 4 Long 0 10,First,#,input_kel,u10,-1,-1;u15 "U15" true true false 4 Long 0 10,First,#,input_kel,u15,-1,-1;u20 "U20" true true false 4 Long 0 10,First,#,input_kel,u20,-1,-1;u25 "U25" true true false 4 Long 0 10,First,#,input_kel,u25,-1,-1;u30 "U30" true true false 4 Long 0 10,First,#,input_kel,u30,-1,-1;u35 "U35" true true false 4 Long 0 10,First,#,input_kel,u35,-1,-1;u40 "U40" true true false 4 Long 0 10,First,#,input_kel,u40,-1,-1;u45 "U45" true true false 4 Long 0 10,First,#,input_kel,u45,-1,-1;u50 "U50" true true false 4 Long 0 10,First,#,input_kel,u50,-1,-1;u55 "U55" true true false 4 Long 0 10,First,#,input_kel,u55,-1,-1;u60 "U60" true true false 4 Long 0 10,First,#,input_kel,u60,-1,-1;u65 "U65" true true false 4 Long 0 10,First,#,input_kel,u65,-1,-1;u70 "U70" true true false 4 Long 0 10,First,#,input_kel,u70,-1,-1;u75 "U75" true true false 4 Long 0 10,First,#,input_kel,u75,-1,-1;field9 "FIELD9" true true false 8000 Text 0 0,First,#,input_kel,field9,0,8000;field10 "FIELD10" true true false 8000 Text 0 0,First,#,input_kel,field10,0,8000;lhr_2018 "LHR_2018" true true false 4 Long 0 10,First,#,input_kel,lhr_2018,-1,-1;lhr_sebelum_2018 "LHR_SEBELUM_2018" true true false 4 Long 0 10,First,#,input_kel,lhr_sebelum_2018,-1,-1;lhr_2019 "LHR_2019" true true false 4 Long 0 10,First,#,input_kel,lhr_2019,-1,-1;lhr_sebelum_2019 "LHR_SEBELUM_2019" true true false 4 Long 0 10,First,#,input_kel,lhr_sebelum_2019,-1,-1;lhr_2020 "LHR_2020" true true false 4 Long 0 10,First,#,input_kel,lhr_2020,-1,-1;lhr_sebelum_2020 "LHR_SEBELUM_2020" true true false 4 Long 0 10,First,#,input_kel,lhr_sebelum_2020,-1,-1;lhr_2021 "LHR_2021" true true false 4 Long 0 10,First,#,input_kel,lhr_2021,-1,-1;lhr_sebelum_2021 "LHR_SEBELUM_2021" true true false 4 Long 0 10,First,#,input_kel,lhr_sebelum_2021,-1,-1;lhr_2022 "LHR_2022" true true false 4 Long 0 10,First,#,input_kel,lhr_2022,-1,-1;lhr_sebelum_2022 "LHR_SEBELUM_2022" true true false 4 Long 0 10,First,#,input_kel,lhr_sebelum_2022,-1,-1;pertumbuhan_2018 "PERTUMBUHAN_2018" true true false 4 Long 0 10,First,#,input_kel,pertumbuhan_2018,-1,-1;pertumbuhan_2019 "PERTUMBUHAN_2019" true true false 4 Long 0 10,First,#,input_kel,pertumbuhan_2019,-1,-1;pertumbuhan_2020 "PERTUMBUHAN_2020" true true false 4 Long 0 10,First,#,input_kel,pertumbuhan_2020,-1,-1;pertumbuhan_2021 "PERTUMBUHAN_2021" true true false 4 Long 0 10,First,#,input_kel,pertumbuhan_2021,-1,-1;pertumbuhan_2022 "PERTUMBUHAN_2022" true true false 4 Long 0 10,First,#,input_kel,pertumbuhan_2022,-1,-1;field11 "FIELD11" true true false 8000 Text 0 0,First,#,input_kel,field11,0,8000;field12 "FIELD12" true true false 8000 Text 0 0,First,#,input_kel,field12,0,8000;usia_sekolah5_6 "USIA_SEKOLAH5_6" true true false 4 Long 0 10,First,#,input_kel,usia_sekolah5_6,-1,-1;usia_sekolah7_12 "USIA_SEKOLAH7_12" true true false 4 Long 0 10,First,#,input_kel,usia_sekolah7_12,-1,-1;usia_sekolah12_15 "USIA_SEKOLAH12_15" true true false 4 Long 0 10,First,#,input_kel,usia_sekolah12_15,-1,-1;usia_sekolah16_18 "USIA_SEKOLAH16_18" true true false 4 Long 0 10,First,#,input_kel,usia_sekolah16_18,-1,-1;field13 "FIELD13" true true false 8000 Text 0 0,First,#,input_kel,field13,0,8000;field14 "FIELD14" true true false 8000 Text 0 0,First,#,input_kel,field14,0,8000;tidak_blm_sekolah "TIDAK_BLM_SEKOLAH" true true false 4 Long 0 10,First,#,input_kel,tidak_blm_sekolah,-1,-1;belum_tamat_sd "BELUM_TAMAT_SD" true true false 4 Long 0 10,First,#,input_kel,belum_tamat_sd,-1,-1;tamat_sd "TAMAT_SD" true true false 4 Long 0 10,First,#,input_kel,tamat_sd,-1,-1;sltp "SLTP" true true false 4 Long 0 10,First,#,input_kel,sltp,-1,-1;slta "SLTA" true true false 4 Long 0 10,First,#,input_kel,slta,-1,-1;d1_dan_d2 "D1_DAN_D2" true true false 4 Long 0 10,First,#,input_kel,d1_dan_d2,-1,-1;d3 "D3" true true false 4 Long 0 10,First,#,input_kel,d3,-1,-1;s1 "S1" true true false 4 Long 0 10,First,#,input_kel,s1,-1,-1;s2 "S2" true true false 4 Long 0 10,First,#,input_kel,s2,-1,-1;s3 "S3" true true false 4 Long 0 10,First,#,input_kel,s3,-1,-1;field15 "FIELD15" true true false 8000 Text 0 0,First,#,input_kel,field15,0,8000;field16 "FIELD16" true true false 8000 Text 0 0,First,#,input_kel,field16,0,8000;o "O" true true false 4 Long 0 10,First,#,input_kel,o,-1,-1;b_ "B-" true true false 4 Long 0 10,First,#,input_kel,b_,-1,-1;b1 "B+" true true false 4 Long 0 10,First,#,input_kel,b1,-1,-1;o_ "O+" true true false 4 Long 0 10,First,#,input_kel,o_,-1,-1;ab_ "AB-" true true false 4 Long 0 10,First,#,input_kel,ab_,-1,-1;a "A" true true false 4 Long 0 10,First,#,input_kel,a,-1,-1;tidak_tahu "TIDAK_TAHU" true true false 4 Long 0 10,First,#,input_kel,tidak_tahu,-1,-1;ab1 "AB+" true true false 4 Long 0 10,First,#,input_kel,ab1,-1,-1;a_ "A+" true true false 4 Long 0 10,First,#,input_kel,a_,-1,-1;a1 "A-" true true false 4 Long 0 10,First,#,input_kel,a1,-1,-1;o1 "O-" true true false 4 Long 0 10,First,#,input_kel,o1,-1,-1;b "B" true true false 4 Long 0 10,First,#,input_kel,b,-1,-1;ab "AB" true true false 4 Long 0 10,First,#,input_kel,ab,-1,-1;field17 "FIELD17" true true false 8000 Text 0 0,First,#,input_kel,field17,0,8000;field18 "FIELD18" true true false 8000 Text 0 0,First,#,input_kel,field18,0,8000;pensiunan "PENSIUNAN" true true false 4 Long 0 10,First,#,input_kel,pensiunan,-1,-1;mengurus_rumah_tangga "MENGURUS_RUMAH_TANGGA" true true false 4 Long 0 10,First,#,input_kel,mengurus_rumah_tangga,-1,-1;belum_tidak_bekerja "BELUM_TIDAK_BEKERJA" true true false 4 Long 0 10,First,#,input_kel,belum_tidak_bekerja,-1,-1;lainnya "LAINNYA" true true false 8000 Text 0 0,First,#,input_kel,lainnya,0,8000;perdagangan "PERDAGANGAN" true true false 4 Long 0 10,First,#,input_kel,perdagangan,-1,-1;perawat "PERAWAT" true true false 4 Long 0 10,First,#,input_kel,perawat,-1,-1;nelayan "NELAYAN" true true false 4 Long 0 10,First,#,input_kel,nelayan,-1,-1;pelajar_mahasiswa "PELAJAR_MAHASISWA" true true false 4 Long 0 10,First,#,input_kel,pelajar_mahasiswa,-1,-1;guru "GURU" true true false 4 Long 0 10,First,#,input_kel,guru,-1,-1;wiraswasta "WIRASWASTA" true true false 4 Long 0 10,First,#,input_kel,wiraswasta,-1,-1;pengacara "PENGACARA" true true false 4 Long 0 10,First,#,input_kel,pengacara,-1,-1;field19 "FIELD19" true true false 8000 Text 0 0,First,#,input_kel,field19,0,8000;field20 "FIELD20" true true false 8000 Text 0 0,First,#,input_kel,field20,0,8000', '', '')
				logProcess.logging_process_info("Success to append new data to feature service - KELURAHAN.")
			except Exception as e:
				logProcess.logging_process_error("Error appending data.")
				raise(e)
			

if __name__ == "__main__":
	try:
		upload_file = MyWatcher.run()
		print(upload_file)
		uploadFile.create_archiveTable()
		uploadFile.joinTable()
	except Exception as e:
		logProcess.logging_process_error("There's error encountered.")
		raise(e)
